{
  "audit_metadata": {
    "project_id": "of-scheduler-proj",
    "timestamp": "2025-09-30T20:48:58Z",
    "generated_by": "bq_audit_script_v3_enhanced"
  },
  "scheduled_queries": [],
  "datasets": [
    {
      "id": "eros_assertions",
      "description": "EROS assertions dataset for Dataform testing",
      "location": "US",
      "created": "2025-09-17 01:46:18",
      "modified": "2025-09-17 01:46:18",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [],
      "views": [
        {
          "id": "creator_tier_assignments_not_null_core",
          "type": "VIEW",
          "description": "creator_tier_assignments: critical fields present + valid ranges (today)",
          "created": "2025-09-30 20:34:29",
          "modified": "2025-09-30 20:34:29",
          "query": "SELECT *\nFROM `of-scheduler-proj.eros_messaging_feat.creator_tier_assignments`\nWHERE assignment_date = CURRENT_DATE()\n  AND (\n    username_std IS NULL OR\n    full_tier_assignment IS NULL OR\n    min_daily_messages IS NULL OR\n    max_daily_messages IS NULL OR\n    min_daily_messages > max_daily_messages\n  )",
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "final_page_type",
              "type": "STRING"
            },
            {
              "name": "messaging_strategy",
              "type": "STRING"
            },
            {
              "name": "is_primary_page",
              "type": "BOOLEAN"
            },
            {
              "name": "base_tier",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "tier_score",
              "type": "FLOAT"
            },
            {
              "name": "tier_confidence",
              "type": "STRING"
            },
            {
              "name": "tier_description",
              "type": "STRING"
            },
            {
              "name": "base_daily_quota",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_drip_bumps",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_renewals",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_wall_posts",
              "type": "INTEGER"
            },
            {
              "name": "revenue_pct",
              "type": "FLOAT"
            },
            {
              "name": "followers_pct",
              "type": "FLOAT"
            },
            {
              "name": "buy_rate_pct",
              "type": "FLOAT"
            },
            {
              "name": "conversion_performance",
              "type": "STRING"
            },
            {
              "name": "revenue_performance",
              "type": "STRING"
            },
            {
              "name": "performance_risk",
              "type": "STRING"
            },
            {
              "name": "subscription_price",
              "type": "FLOAT"
            },
            {
              "name": "total_followers",
              "type": "INTEGER"
            },
            {
              "name": "weekly_revenue",
              "type": "FLOAT"
            },
            {
              "name": "rebill_rate",
              "type": "FLOAT"
            },
            {
              "name": "ppv_sends_7d",
              "type": "INTEGER"
            },
            {
              "name": "ppv_buys_7d",
              "type": "INTEGER"
            },
            {
              "name": "buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "assignment_date",
              "type": "DATE"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "assignment_version",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "creator_tier_tier_values",
          "type": "VIEW",
          "description": "creator_tier_assignments: allowed full_tier_assignment values",
          "created": "2025-09-30 20:34:29",
          "modified": "2025-09-30 20:34:29",
          "query": "SELECT c.*\nFROM `of-scheduler-proj.eros_messaging_feat.creator_tier_assignments` c\nWHERE LOWER(COALESCE(c.full_tier_assignment, '')) NOT IN (\n  'a_free', 'a_paid',\n  'b_free', 'b_paid',\n  'c_free', 'c_paid',\n  'd_free', 'd_paid',\n  'enterprise', 'vip'\n)\nLIMIT 100",
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "final_page_type",
              "type": "STRING"
            },
            {
              "name": "messaging_strategy",
              "type": "STRING"
            },
            {
              "name": "is_primary_page",
              "type": "BOOLEAN"
            },
            {
              "name": "base_tier",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "tier_score",
              "type": "FLOAT"
            },
            {
              "name": "tier_confidence",
              "type": "STRING"
            },
            {
              "name": "tier_description",
              "type": "STRING"
            },
            {
              "name": "base_daily_quota",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_drip_bumps",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_renewals",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_wall_posts",
              "type": "INTEGER"
            },
            {
              "name": "revenue_pct",
              "type": "FLOAT"
            },
            {
              "name": "followers_pct",
              "type": "FLOAT"
            },
            {
              "name": "buy_rate_pct",
              "type": "FLOAT"
            },
            {
              "name": "conversion_performance",
              "type": "STRING"
            },
            {
              "name": "revenue_performance",
              "type": "STRING"
            },
            {
              "name": "performance_risk",
              "type": "STRING"
            },
            {
              "name": "subscription_price",
              "type": "FLOAT"
            },
            {
              "name": "total_followers",
              "type": "INTEGER"
            },
            {
              "name": "weekly_revenue",
              "type": "FLOAT"
            },
            {
              "name": "rebill_rate",
              "type": "FLOAT"
            },
            {
              "name": "ppv_sends_7d",
              "type": "INTEGER"
            },
            {
              "name": "ppv_buys_7d",
              "type": "INTEGER"
            },
            {
              "name": "buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "assignment_date",
              "type": "DATE"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "assignment_version",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "eros_messaging_stg_mass_messages_assertions_rowConditions",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-30 10:12:42",
          "modified": "2025-09-30 10:12:42",
          "query": "SELECT\n  'sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)' AS failing_row_condition,\n  *\nFROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\nWHERE NOT (sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY))\nUNION ALL\nSELECT\n  'message_sk IS NOT NULL' AS failing_row_condition,\n  *\nFROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\nWHERE NOT (message_sk IS NOT NULL)\nUNION ALL\nSELECT\n  'sending_date IS NOT NULL' AS failing_row_condition,\n  *\nFROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\nWHERE NOT (sending_date IS NOT NULL)\nUNION ALL\nSELECT\n  'username_std IS NOT NULL' AS failing_row_condition,\n  *\nFROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\nWHERE NOT (username_std IS NOT NULL)",
          "schema": [
            {
              "name": "failing_row_condition",
              "type": "STRING"
            },
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "sending_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "price",
              "type": "FLOAT"
            },
            {
              "name": "sent_count",
              "type": "INTEGER"
            },
            {
              "name": "viewed_count",
              "type": "INTEGER"
            },
            {
              "name": "purchased_count",
              "type": "INTEGER"
            },
            {
              "name": "earnings_total",
              "type": "FLOAT"
            },
            {
              "name": "message_text",
              "type": "STRING"
            },
            {
              "name": "source_file",
              "type": "STRING"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "sending_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "eros_messaging_stg_mass_messages_assertions_uniqueKey_0",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-30 02:49:28",
          "modified": "2025-09-30 02:49:28",
          "query": "SELECT\n  *\nFROM (\n  SELECT\n    message_sk,\n    COUNT(1) AS index_row_count\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  GROUP BY message_sk\n  ) AS data\nWHERE index_row_count > 1",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "index_row_count",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "mass_messages_freshness",
          "type": "VIEW",
          "description": "mass_messages: max(sending_date) within last 24h",
          "created": "2025-09-30 11:52:31",
          "modified": "2025-09-30 11:52:31",
          "query": "WITH s AS (\n  SELECT MAX(sending_date) AS max_dt\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n)\nSELECT *\nFROM s\nWHERE COALESCE(max_dt, DATE '1900-01-01') < DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)",
          "schema": [
            {
              "name": "max_dt",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "mass_messages_freshness_24h",
          "type": "VIEW",
          "description": "mass_messages: max(sending_date) within last 24h",
          "created": "2025-09-30 11:52:30",
          "modified": "2025-09-30 11:52:30",
          "query": "WITH s AS (\n  SELECT MAX(sending_date) AS max_dt\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n)\nSELECT *\nFROM s\nWHERE COALESCE(max_dt, DATE '1900-01-01') < DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)",
          "schema": [
            {
              "name": "max_dt",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "mass_messages_partition_check",
          "type": "VIEW",
          "description": "mass_messages: partitions present (>=1 row) for the last 14 days",
          "created": "2025-09-30 11:52:30",
          "modified": "2025-09-30 11:52:30",
          "query": "WITH days AS (\n  SELECT d\n  FROM UNNEST(GENERATE_DATE_ARRAY(DATE_SUB(CURRENT_DATE(), INTERVAL 13 DAY), CURRENT_DATE())) d\n),\nobserved AS (\n  SELECT sending_date AS d\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 13 DAY) AND CURRENT_DATE()\n  GROUP BY d\n)\nSELECT days.d AS missing_partition_date\nFROM days\nLEFT JOIN observed USING (d)\nWHERE observed.d IS NULL",
          "schema": [
            {
              "name": "missing_partition_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "mass_messages_quality",
          "type": "VIEW",
          "description": "Data quality checks for mass_messages table",
          "created": "2025-09-30 20:34:33",
          "modified": "2025-09-30 20:34:33",
          "query": "SELECT * FROM (\n  -- Check 1: duplicate message_sk in the last 14 days\n  SELECT\n    'DUPLICATE_MESSAGE_SK' AS failing_row_condition,\n    message_sk,\n    COUNT(*) AS dup_count\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n  GROUP BY message_sk\n  HAVING COUNT(*) > 1\n\n  UNION ALL\n\n  -- Check 2: NULL keys (should not happen)\n  SELECT\n    'NULL_KEYS' AS failing_row_condition,\n    message_sk,\n    1 AS cnt\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n    AND (message_sk IS NULL OR username_std IS NULL OR sending_date IS NULL)\n\n  UNION ALL\n\n  -- Check 3: Invalid date ranges\n  SELECT\n    'INVALID_DATES' AS failing_row_condition,\n    message_sk,\n    1 AS cnt\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n    AND (sending_date < DATE '2020-01-01' OR sending_date > DATE '2030-01-01')\n\n  UNION ALL\n\n  -- Check 4: Invalid prices\n  SELECT\n    'INVALID_PRICES' AS failing_row_condition,\n    message_sk,\n    1 AS cnt\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n    AND price IS NOT NULL\n    AND (price < 0 OR price > 1000)\n) AS failures",
          "schema": [
            {
              "name": "failing_row_condition",
              "type": "STRING"
            },
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "dup_count",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "mass_messages_row_window",
          "type": "VIEW",
          "description": "mass_messages: no duplicates after ROW_NUMBER() on 14 days",
          "created": "2025-09-30 20:34:34",
          "modified": "2025-09-30 20:34:34",
          "query": "WITH ranked AS (\n  SELECT\n    message_sk,\n    loaded_at,\n    ROW_NUMBER() OVER (PARTITION BY message_sk ORDER BY loaded_at DESC) AS rn\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n)\nSELECT *\nFROM ranked\nWHERE rn > 1",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "rn",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "mass_messages_unique_key",
          "type": "VIEW",
          "description": "mass_messages: message_sk unique within 14 days",
          "created": "2025-09-30 20:34:34",
          "modified": "2025-09-30 20:34:34",
          "query": "WITH d AS (\n  SELECT message_sk\n  FROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n)\nSELECT message_sk, COUNT(*) AS dup_cnt\nFROM d\nGROUP BY message_sk\nHAVING COUNT(*) > 1",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "dup_cnt",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "message_sk_unique",
          "type": "VIEW",
          "description": "Message surrogate keys must be unique",
          "created": "2025-09-30 00:47:43",
          "modified": "2025-09-30 00:47:43",
          "query": "SELECT message_sk, COUNT(*) as duplicate_count\nFROM `of-scheduler-proj.eros_messaging_stg.mass_messages`\nWHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 30 DAY)\nGROUP BY message_sk\nHAVING COUNT(*) > 1",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "duplicate_count",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "messages_enriched_day_values",
          "type": "VIEW",
          "description": "messages_enriched: allowed day-of-week values (14d window)",
          "created": "2025-09-30 20:34:39",
          "modified": "2025-09-30 20:34:39",
          "query": "SELECT me.*\nFROM `of-scheduler-proj.eros_messaging_feat.messages_enriched` me\nWHERE me.sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n  AND LOWER(me.local_day_of_week) NOT IN (\n    'monday','tuesday','wednesday','thursday','friday','saturday','sunday'\n  )",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "sending_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "price",
              "type": "FLOAT"
            },
            {
              "name": "sent_count",
              "type": "INTEGER"
            },
            {
              "name": "viewed_count",
              "type": "INTEGER"
            },
            {
              "name": "purchased_count",
              "type": "INTEGER"
            },
            {
              "name": "earnings_total",
              "type": "FLOAT"
            },
            {
              "name": "message_text",
              "type": "STRING"
            },
            {
              "name": "source_file",
              "type": "STRING"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "sending_date",
              "type": "DATE"
            },
            {
              "name": "local_sending_dt",
              "type": "DATETIME"
            },
            {
              "name": "local_hour",
              "type": "INTEGER"
            },
            {
              "name": "local_day_of_week",
              "type": "STRING"
            },
            {
              "name": "is_weekend",
              "type": "BOOLEAN"
            },
            {
              "name": "purchase_rate",
              "type": "FLOAT"
            },
            {
              "name": "rpm",
              "type": "FLOAT"
            },
            {
              "name": "view_rate",
              "type": "FLOAT"
            }
          ]
        },
        {
          "id": "messages_enriched_freshness_24h",
          "type": "VIEW",
          "description": "messages_enriched: max(sending_date) within last 24h",
          "created": "2025-09-30 11:52:59",
          "modified": "2025-09-30 11:52:59",
          "query": "WITH s AS (\n  SELECT MAX(sending_date) AS max_dt\n  FROM `of-scheduler-proj.eros_messaging_feat.messages_enriched`\n  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n)\nSELECT *\nFROM s\nWHERE COALESCE(max_dt, DATE '1900-01-01') < DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)",
          "schema": [
            {
              "name": "max_dt",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "messages_enriched_not_null_core",
          "type": "VIEW",
          "description": "messages_enriched: critical fields not null (14d window)",
          "created": "2025-09-30 20:34:39",
          "modified": "2025-09-30 20:34:39",
          "query": "SELECT *\nFROM `of-scheduler-proj.eros_messaging_feat.messages_enriched`\nWHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\n  AND (username_std IS NULL OR sending_date IS NULL)\nLIMIT 100",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "sending_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "price",
              "type": "FLOAT"
            },
            {
              "name": "sent_count",
              "type": "INTEGER"
            },
            {
              "name": "viewed_count",
              "type": "INTEGER"
            },
            {
              "name": "purchased_count",
              "type": "INTEGER"
            },
            {
              "name": "earnings_total",
              "type": "FLOAT"
            },
            {
              "name": "message_text",
              "type": "STRING"
            },
            {
              "name": "source_file",
              "type": "STRING"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "sending_date",
              "type": "DATE"
            },
            {
              "name": "local_sending_dt",
              "type": "DATETIME"
            },
            {
              "name": "local_hour",
              "type": "INTEGER"
            },
            {
              "name": "local_day_of_week",
              "type": "STRING"
            },
            {
              "name": "is_weekend",
              "type": "BOOLEAN"
            },
            {
              "name": "purchase_rate",
              "type": "FLOAT"
            },
            {
              "name": "rpm",
              "type": "FLOAT"
            },
            {
              "name": "view_rate",
              "type": "FLOAT"
            }
          ]
        },
        {
          "id": "messages_enriched_unique_key",
          "type": "VIEW",
          "description": "messages_enriched: unique message_sk in last 14d",
          "created": "2025-09-30 20:34:39",
          "modified": "2025-09-30 20:34:39",
          "query": "SELECT message_sk, COUNT(*) as dup_count\nFROM `of-scheduler-proj.eros_messaging_feat.messages_enriched`\nWHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)\nGROUP BY message_sk\nHAVING COUNT(*) > 1",
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "dup_count",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "price_tier_values",
          "type": "VIEW",
          "description": "Price tier values must be from accepted list",
          "created": "2025-09-30 20:34:45",
          "modified": "2025-09-30 20:34:45",
          "query": "SELECT recommended_price_tier, COUNT(*) as invalid_count\nFROM `of-scheduler-proj.eros_pricing_feat.pricing_bands`\nWHERE recommended_price_tier NOT IN ('LOW', 'MEDIUM', 'HIGH', 'PREMIUM')\nGROUP BY recommended_price_tier\nHAVING COUNT(*) > 0",
          "schema": [
            {
              "name": "recommended_price_tier",
              "type": "STRING"
            },
            {
              "name": "invalid_count",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "send_log_freshness_24h",
          "type": "VIEW",
          "description": "send_log: max(action_date) within last 24h",
          "created": "2025-09-30 11:52:29",
          "modified": "2025-09-30 11:52:29",
          "query": "WITH s AS (\n  SELECT MAX(action_date) AS max_dt\n  FROM `of-scheduler-proj.eros_ops.send_log`\n)\nSELECT *\nFROM s\nWHERE COALESCE(max_dt, DATE '1900-01-01') < DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)",
          "schema": [
            {
              "name": "max_dt",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "send_log_partition_check",
          "type": "VIEW",
          "description": "send_log: partitions present for last 7 days (data-driven)",
          "created": "2025-09-30 11:52:29",
          "modified": "2025-09-30 11:52:29",
          "query": "WITH days AS (\n  SELECT d\n  FROM UNNEST(GENERATE_DATE_ARRAY(DATE_SUB(CURRENT_DATE(), INTERVAL 6 DAY), CURRENT_DATE())) d\n),\nobserved AS (\n  SELECT action_date AS d\n  FROM `of-scheduler-proj.eros_ops.send_log`\n  WHERE action_date BETWEEN DATE_SUB(CURRENT_DATE(), INTERVAL 6 DAY) AND CURRENT_DATE()\n  GROUP BY d\n)\nSELECT days.d AS missing_partition_date\nFROM days\nLEFT JOIN observed USING (d)\nWHERE observed.d IS NULL",
          "schema": [
            {
              "name": "missing_partition_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "templates_randomize_minutes_range",
          "type": "VIEW",
          "description": "tier_baseline_templates: randomize_minutes within 0..1440",
          "created": "2025-09-30 20:34:23",
          "modified": "2025-09-30 20:34:23",
          "query": "WITH drip_mins AS (\n  SELECT t.tier_id, ds.randomize_minutes AS rm\n  FROM `of-scheduler-proj.eros_messaging_feat.tier_baseline_templates` t, UNNEST(t.drip_schedule) ds\n  WHERE ds.randomize_minutes IS NOT NULL\n),\nrenewal_mins AS (\n  SELECT t.tier_id, rs.randomize_minutes AS rm\n  FROM `of-scheduler-proj.eros_messaging_feat.tier_baseline_templates` t, UNNEST(t.renewal_schedule) rs\n  WHERE rs.randomize_minutes IS NOT NULL\n)\nSELECT tier_id, rm\nFROM drip_mins\nWHERE NOT (rm BETWEEN 0 AND 1440)\nUNION ALL\nSELECT tier_id, rm\nFROM renewal_mins\nWHERE NOT (rm BETWEEN 0 AND 1440)",
          "schema": [
            {
              "name": "tier_id",
              "type": "STRING"
            },
            {
              "name": "rm",
              "type": "INTEGER"
            }
          ]
        }
      ],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 0,
        "views": 19,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_core",
      "description": "",
      "location": "US",
      "created": "2025-09-19 03:04:12",
      "modified": "2025-09-19 03:04:12",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [],
      "views": [
        {
          "id": "vw_caption_bank",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 03:54:56",
          "modified": "2025-09-19 03:54:56",
          "query": "WITH base AS (\n  SELECT\n    m.sender AS creator_id,\n    CAST(NULL AS STRING) AS action_type,         -- V1: type-agnostic\n    TRIM(m.message) AS caption_text,\n\n    -- Coerce strings to numeric\n    SAFE_CAST(REPLACE(m.earnings,  '$', '') AS NUMERIC) AS revenue_usd,\n    SAFE_CAST(m.purchased AS INT64)                     AS buyers,\n    SAFE_CAST(m.viewed AS INT64)                        AS clicks,\n    SAFE_CAST(m.sent AS INT64)                          AS impressions,\n    SAFE_CAST(REPLACE(m.price,     '$', '') AS NUMERIC) AS price_usd,\n\n    -- Resilient timestamp parsing (try several formats, then generic)\n    COALESCE(\n      SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%E*S%Ez', m.sending_time), -- with tz/frac sec\n      SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S%Ez',  m.sending_time),\n      SAFE.PARSE_TIMESTAMP('%Y-%m-%d %H:%M:%S',     m.sending_time),\n      SAFE.TIMESTAMP(m.sending_time)                                   -- generic fallback\n    ) AS send_ts_raw\n  FROM `of-scheduler-proj.eros_source.facts_messages_all` m\n  WHERE m.message IS NOT NULL\n),\nfiltered AS (\n  SELECT\n    creator_id,\n    action_type,\n    caption_text,\n    revenue_usd, buyers, clicks, impressions, price_usd,\n    send_ts_raw,\n    DATETIME(send_ts_raw, 'America/Denver') AS sent_dt_mtz,\n    CASE\n      WHEN EXTRACT(HOUR FROM TIME(send_ts_raw, 'America/Denver')) BETWEEN 5  AND 10 THEN 'morning'\n      WHEN EXTRACT(HOUR FROM TIME(send_ts_raw, 'America/Denver')) BETWEEN 11 AND 16 THEN 'day'\n      WHEN EXTRACT(HOUR FROM TIME(send_ts_raw, 'America/Denver')) BETWEEN 17 AND 22 THEN 'evening'\n      ELSE 'late'\n    END AS time_of_day_tag\n  FROM base\n  WHERE send_ts_raw IS NOT NULL\n    AND DATE(send_ts_raw) BETWEEN DATE_SUB(CURRENT_DATE('America/Denver'), INTERVAL 90 DAY)\n                              AND CURRENT_DATE('America/Denver')\n),\ncanon AS (\n  SELECT\n    creator_id,\n    action_type,\n    time_of_day_tag,\n    caption_text,\n    LOWER(REGEXP_REPLACE(caption_text, r'\\s+', ' ')) AS caption_canonical,\n    revenue_usd, buyers, clicks, impressions, price_usd, sent_dt_mtz\n  FROM filtered\n),\nagg AS (\n  SELECT\n    creator_id,\n    action_type,\n    time_of_day_tag,\n    caption_canonical,\n    ANY_VALUE(SUBSTR(caption_canonical, 1, 500)) AS caption_preview,\n    COUNT(*)                                      AS uses,\n    COUNT(DISTINCT DATE(sent_dt_mtz))             AS days_used,\n    MAX(sent_dt_mtz)                              AS last_used_mtz,\n    SUM(revenue_usd)                              AS revenue_total_usd,\n    SUM(buyers)                                   AS buyers_total,\n    SUM(clicks)                                   AS clicks_total,\n    SUM(impressions)                              AS impressions_total,\n    APPROX_QUANTILES(price_usd, 100)[OFFSET(50)]  AS median_price_usd\n  FROM canon\n  GROUP BY 1,2,3,4\n),\nmetrics AS (\n  SELECT\n    *,\n    SAFE_DIVIDE(clicks_total, impressions_total)                 AS open_rate,   -- renamed (was ctr)\n    SAFE_DIVIDE(revenue_total_usd, NULLIF(uses, 0))              AS rev_per_use,\n    SAFE_DIVIDE(revenue_total_usd, NULLIF(impressions_total, 0)) AS rev_per_impr\n  FROM agg\n),\nranked AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER (\n      PARTITION BY creator_id, action_type, time_of_day_tag\n      ORDER BY revenue_total_usd DESC, rev_per_impr DESC, last_used_mtz DESC\n    ) AS rank_within_bucket\n  FROM metrics\n)\nSELECT\n  creator_id,\n  action_type,\n  time_of_day_tag,\n  caption_canonical AS caption_text,\n  caption_preview,\n  uses,\n  days_used,\n  last_used_mtz,\n  revenue_total_usd,\n  buyers_total,\n  clicks_total,\n  impressions_total,\n  open_rate,\n  rev_per_use,\n  rev_per_impr,\n  median_price_usd,\n  rank_within_bucket\nFROM ranked",
          "schema": [
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "STRING"
            },
            {
              "name": "time_of_day_tag",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_preview",
              "type": "STRING"
            },
            {
              "name": "uses",
              "type": "INTEGER"
            },
            {
              "name": "days_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_mtz",
              "type": "DATETIME"
            },
            {
              "name": "revenue_total_usd",
              "type": "NUMERIC"
            },
            {
              "name": "buyers_total",
              "type": "INTEGER"
            },
            {
              "name": "clicks_total",
              "type": "INTEGER"
            },
            {
              "name": "impressions_total",
              "type": "INTEGER"
            },
            {
              "name": "open_rate",
              "type": "FLOAT"
            },
            {
              "name": "rev_per_use",
              "type": "NUMERIC"
            },
            {
              "name": "rev_per_impr",
              "type": "NUMERIC"
            },
            {
              "name": "median_price_usd",
              "type": "NUMERIC"
            },
            {
              "name": "rank_within_bucket",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "vw_caption_bank_rbac",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 04:03:41",
          "modified": "2025-09-19 04:03:41",
          "query": "SELECT\n  cb.*,\n  -- compatibility alias for downstream queries/UI that expect 'ctr'\n  cb.open_rate AS ctr\nFROM `of-scheduler-proj.eros_core.vw_caption_bank` cb\nJOIN `of-scheduler-proj.eros_source.scheduler_assignments_final` a\n  ON LOWER(TRIM(a.username_std)) = LOWER(TRIM(cb.creator_id))\nWHERE LOWER(a.scheduler_email) = LOWER(SESSION_USER())",
          "schema": [
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "STRING"
            },
            {
              "name": "time_of_day_tag",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_preview",
              "type": "STRING"
            },
            {
              "name": "uses",
              "type": "INTEGER"
            },
            {
              "name": "days_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_mtz",
              "type": "DATETIME"
            },
            {
              "name": "revenue_total_usd",
              "type": "NUMERIC"
            },
            {
              "name": "buyers_total",
              "type": "INTEGER"
            },
            {
              "name": "clicks_total",
              "type": "INTEGER"
            },
            {
              "name": "impressions_total",
              "type": "INTEGER"
            },
            {
              "name": "open_rate",
              "type": "FLOAT"
            },
            {
              "name": "rev_per_use",
              "type": "NUMERIC"
            },
            {
              "name": "rev_per_impr",
              "type": "NUMERIC"
            },
            {
              "name": "median_price_usd",
              "type": "NUMERIC"
            },
            {
              "name": "rank_within_bucket",
              "type": "INTEGER"
            },
            {
              "name": "ctr",
              "type": "FLOAT"
            }
          ]
        },
        {
          "id": "vw_horizon_health_24_30h",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 04:28:05",
          "modified": "2025-09-19 04:28:05",
          "query": "SELECT\n  COUNT(*) AS rows_horizon,\n  COUNTIF(fatigue_risk_band = 'HIGH') AS high_fatigue_horizon\nFROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1_report`\nWHERE TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) BETWEEN 24 AND 30",
          "schema": [
            {
              "name": "rows_horizon",
              "type": "INTEGER"
            },
            {
              "name": "high_fatigue_horizon",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "vw_scheduler_action_links",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 04:02:08",
          "modified": "2025-09-19 04:02:08",
          "query": "SELECT\n  rec_id,\n  creator_id,\n  plan_date,\n  recommended_time,\n  recommended_price_usd,\n  -- TODO: replace <FORM_ID> with your Google Form ID\n  CONCAT(\n    'https://docs.google.com/forms/d/e/<FORM_ID>/viewform?usp=pp_url',\n    '&entry.rec_id=',  CAST(rec_id AS STRING),\n    '&entry.creator=', creator_id,\n    '&entry.plan_date=', CAST(plan_date AS STRING),\n    '&entry.time=', CAST(recommended_time AS STRING),\n    '&entry.price=', CAST(recommended_price_usd AS STRING),\n    '&entry.action=ACCEPTED'\n  ) AS link_accept,\n  CONCAT(\n    'https://docs.google.com/forms/d/e/<FORM_ID>/viewform?usp=pp_url',\n    '&entry.rec_id=',  CAST(rec_id AS STRING),\n    '&entry.creator=', creator_id,\n    '&entry.plan_date=', CAST(plan_date AS STRING),\n    '&entry.time=', CAST(recommended_time AS STRING),\n    '&entry.price=', CAST(recommended_price_usd AS STRING),\n    '&entry.action=EDIT'\n  ) AS link_edit,\n  CONCAT(\n    'https://docs.google.com/forms/d/e/<FORM_ID>/viewform?usp=pp_url',\n    '&entry.rec_id=',  CAST(rec_id AS STRING),\n    '&entry.creator=', creator_id,\n    '&entry.plan_date=', CAST(plan_date AS STRING),\n    '&entry.time=', CAST(recommended_time AS STRING),\n    '&entry.price=', CAST(recommended_price_usd AS STRING),\n    '&entry.action=OVERRIDE'\n  ) AS link_override\nFROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1`",
          "schema": [
            {
              "name": "rec_id",
              "type": "INTEGER"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "recommended_time",
              "type": "TIME"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "link_accept",
              "type": "STRING"
            },
            {
              "name": "link_edit",
              "type": "STRING"
            },
            {
              "name": "link_override",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "vw_scheduler_checklist_helper",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 03:49:05",
          "modified": "2025-09-19 03:49:05",
          "query": "SELECT\n  c.creator_id,\n  c.plan_date,\n  -- WINDOWS (local time). Use in LS CASE expressions:\n  -- morning: 05-10, day: 11-16, evening: 17-22, late: 23-04\n  -- Counts for planned sends by window (approximate with recommended_time)\n  COUNTIF(EXTRACT(HOUR FROM c.recommended_time) BETWEEN 5  AND 10) AS planned_morning_cnt,\n  COUNTIF(EXTRACT(HOUR FROM c.recommended_time) BETWEEN 17 AND 22) AS planned_evening_cnt,\n  -- Placeholder NULLs for items not yet in the mart (LS will show \"â€”\")\n  CAST(NULL AS BOOL) AS has_renew_8_4_12,\n  CAST(NULL AS BOOL) AS has_wall_post,\n  CAST(NULL AS BOOL) AS deletions_done,\n  CAST(NULL AS BOOL) AS ppv_variety_ok,\n  CAST(NULL AS BOOL) AS link_drops_done,\n  -- variety today (very simple: distinct minute count)\n  COUNT(DISTINCT FORMAT_TIME('%H:%M', c.recommended_time)) >= 3 AS variety_today_ok\nFROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1_rbac` c\nGROUP BY 1,2",
          "schema": [
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "planned_morning_cnt",
              "type": "INTEGER"
            },
            {
              "name": "planned_evening_cnt",
              "type": "INTEGER"
            },
            {
              "name": "has_renew_8_4_12",
              "type": "BOOLEAN"
            },
            {
              "name": "has_wall_post",
              "type": "BOOLEAN"
            },
            {
              "name": "deletions_done",
              "type": "BOOLEAN"
            },
            {
              "name": "ppv_variety_ok",
              "type": "BOOLEAN"
            },
            {
              "name": "link_drops_done",
              "type": "BOOLEAN"
            },
            {
              "name": "variety_today_ok",
              "type": "BOOLEAN"
            }
          ]
        },
        {
          "id": "vw_scheduler_checklist_horizon_24_30h",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 04:09:12",
          "modified": "2025-09-19 04:09:12",
          "query": "WITH horizon AS (\n  SELECT *\n  FROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1_report`\n  WHERE TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) BETWEEN 24 AND 30\n)\nSELECT\n  creator_id,\n  DATE(recommended_ts_mtz) AS plan_date_horizon,\n  COUNTIF(EXTRACT(HOUR FROM recommended_time) BETWEEN 5  AND 10) AS horizon_morning_cnt,\n  COUNTIF(EXTRACT(HOUR FROM recommended_time) BETWEEN 17 AND 22) AS horizon_evening_cnt,\n  COUNT(DISTINCT FORMAT_TIME('%H:%M', recommended_time)) >= 3    AS horizon_variety_ok\nFROM horizon\nGROUP BY 1,2",
          "schema": [
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date_horizon",
              "type": "DATE"
            },
            {
              "name": "horizon_morning_cnt",
              "type": "INTEGER"
            },
            {
              "name": "horizon_evening_cnt",
              "type": "INTEGER"
            },
            {
              "name": "horizon_variety_ok",
              "type": "BOOLEAN"
            }
          ]
        },
        {
          "id": "vw_scheduler_cockpit_v1",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 03:47:39",
          "modified": "2025-09-19 03:47:39",
          "query": "SELECT * FROM `of-scheduler-proj.eros_core_dim.vw_scheduler_cockpit_v1`",
          "schema": [
            {
              "name": "rec_id",
              "type": "INTEGER"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "INTEGER"
            },
            {
              "name": "recommended_time",
              "type": "TIME"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "expected_revenue_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_low_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_high_usd",
              "type": "INTEGER"
            },
            {
              "name": "confidence",
              "type": "INTEGER"
            },
            {
              "name": "model_version",
              "type": "INTEGER"
            },
            {
              "name": "view_refreshed_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "fatigue_score",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_trend_30d",
              "type": "INTEGER"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "events",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "event_type",
                  "type": "STRING"
                },
                {
                  "name": "title",
                  "type": "STRING"
                },
                {
                  "name": "start_ts",
                  "type": "TIMESTAMP"
                },
                {
                  "name": "end_ts",
                  "type": "TIMESTAMP"
                }
              ]
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            },
            {
              "name": "reason_price_code",
              "type": "STRING"
            },
            {
              "name": "top3_alternatives",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "alt_rank",
                  "type": "STRING"
                },
                {
                  "name": "hour_of_day",
                  "type": "INTEGER"
                },
                {
                  "name": "alt_time",
                  "type": "TIME"
                },
                {
                  "name": "alt_price_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_low_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_high_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_confidence",
                  "type": "INTEGER"
                }
              ]
            },
            {
              "name": "recommended_ts_mtz",
              "type": "TIMESTAMP"
            },
            {
              "name": "due_in_hours",
              "type": "INTEGER"
            },
            {
              "name": "due_chip",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "vw_scheduler_cockpit_v1_rbac",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 03:47:40",
          "modified": "2025-09-19 03:47:40",
          "query": "SELECT *\nFROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1`\nWHERE LOWER(scheduler_email) = LOWER(SESSION_USER())",
          "schema": [
            {
              "name": "rec_id",
              "type": "INTEGER"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "INTEGER"
            },
            {
              "name": "recommended_time",
              "type": "TIME"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "expected_revenue_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_low_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_high_usd",
              "type": "INTEGER"
            },
            {
              "name": "confidence",
              "type": "INTEGER"
            },
            {
              "name": "model_version",
              "type": "INTEGER"
            },
            {
              "name": "view_refreshed_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "fatigue_score",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_trend_30d",
              "type": "INTEGER"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "events",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "event_type",
                  "type": "STRING"
                },
                {
                  "name": "title",
                  "type": "STRING"
                },
                {
                  "name": "start_ts",
                  "type": "TIMESTAMP"
                },
                {
                  "name": "end_ts",
                  "type": "TIMESTAMP"
                }
              ]
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            },
            {
              "name": "reason_price_code",
              "type": "STRING"
            },
            {
              "name": "top3_alternatives",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "alt_rank",
                  "type": "STRING"
                },
                {
                  "name": "hour_of_day",
                  "type": "INTEGER"
                },
                {
                  "name": "alt_time",
                  "type": "TIME"
                },
                {
                  "name": "alt_price_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_low_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_high_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_confidence",
                  "type": "INTEGER"
                }
              ]
            },
            {
              "name": "recommended_ts_mtz",
              "type": "TIMESTAMP"
            },
            {
              "name": "due_in_hours",
              "type": "INTEGER"
            },
            {
              "name": "due_chip",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "vw_scheduler_cockpit_v1_report",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 04:09:01",
          "modified": "2025-09-19 04:09:01",
          "query": "SELECT\n  rec_id,\n  creator_id,\n  plan_date,\n  scheduler_email,\n  action_type,\n  recommended_time,\n  recommended_price_usd,\n  expected_revenue_usd,\n  expected_revenue_low_usd,\n  expected_revenue_high_usd,\n  confidence,\n  model_version,\n  view_refreshed_at,\n  fatigue_score,\n  fatigue_trend_30d,\n  fatigue_risk_band,\n  ARRAY_LENGTH(events) AS events_count,\n  reason_time_code,\n  reason_price_code,\n  CASE\n    WHEN EXTRACT(HOUR FROM recommended_time) BETWEEN 5  AND 10 THEN 'morning'\n    WHEN EXTRACT(HOUR FROM recommended_time) BETWEEN 11 AND 16 THEN 'day'\n    WHEN EXTRACT(HOUR FROM recommended_time) BETWEEN 17 AND 22 THEN 'evening'\n    ELSE 'late'\n  END AS time_of_day_tag,\n  -- ensure we always expose recommended_ts_mtz\n  recommended_ts_mtz,\n  due_in_hours,\n  due_chip,\n\n  -- NEW: lead-time fields for advance scheduling\n  TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) AS lead_time_hours,\n  CONCAT('T-', CAST(ABS(TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR)) AS STRING), 'h') AS lead_time_chip,\n  CASE\n    WHEN TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) < 0  THEN 'past'\n    WHEN TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) <= 18 THEN 'urgent'\n    WHEN TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) <= 30 THEN 'in-window'\n    WHEN TIMESTAMP_DIFF(recommended_ts_mtz, CURRENT_TIMESTAMP(), HOUR) <= 72 THEN 'upcoming'\n    ELSE 'later'\n  END AS lead_time_band\nFROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1`",
          "schema": [
            {
              "name": "rec_id",
              "type": "INTEGER"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "INTEGER"
            },
            {
              "name": "recommended_time",
              "type": "TIME"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "expected_revenue_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_low_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_high_usd",
              "type": "INTEGER"
            },
            {
              "name": "confidence",
              "type": "INTEGER"
            },
            {
              "name": "model_version",
              "type": "INTEGER"
            },
            {
              "name": "view_refreshed_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "fatigue_score",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_trend_30d",
              "type": "INTEGER"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "events_count",
              "type": "INTEGER"
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            },
            {
              "name": "reason_price_code",
              "type": "STRING"
            },
            {
              "name": "time_of_day_tag",
              "type": "STRING"
            },
            {
              "name": "recommended_ts_mtz",
              "type": "TIMESTAMP"
            },
            {
              "name": "due_in_hours",
              "type": "INTEGER"
            },
            {
              "name": "due_chip",
              "type": "STRING"
            },
            {
              "name": "lead_time_hours",
              "type": "INTEGER"
            },
            {
              "name": "lead_time_chip",
              "type": "STRING"
            },
            {
              "name": "lead_time_band",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "vw_scheduler_cockpit_v1_week",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 04:01:52",
          "modified": "2025-09-19 04:01:52",
          "query": "WITH w AS (\n  SELECT\n    rec_id,\n    creator_id,\n    plan_date,\n    scheduler_email,\n    recommended_time,\n    recommended_price_usd,\n    fatigue_risk_band,\n    reason_time_code,\n    due_in_hours\n  FROM `of-scheduler-proj.eros_core.vw_scheduler_cockpit_v1_rbac`\n)\nSELECT\n  creator_id,\n  scheduler_email,\n  plan_date,\n  CONCAT(FORMAT_TIME('%H:%M', recommended_time),' | $',CAST(recommended_price_usd AS STRING)) AS cell_text,\n  fatigue_risk_band,\n  reason_time_code,\n  due_in_hours\nFROM w",
          "schema": [
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "cell_text",
              "type": "STRING"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            },
            {
              "name": "due_in_hours",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "vw_week_slots_7d_rbac",
          "type": "VIEW",
          "description": "7-day weekly slots with scheduler RBAC assignments",
          "created": "2025-09-30 20:34:51",
          "modified": "2025-09-30 20:34:51",
          "query": "WITH next_7_days AS (\n  SELECT date_val as plan_date\n  FROM UNNEST(GENERATE_DATE_ARRAY(\n    CURRENT_DATE('America/New_York'),\n    DATE_ADD(CURRENT_DATE('America/New_York'), INTERVAL 6 DAY)\n  )) as date_val\n),\n\nscheduler_creator_mapping AS (\n  SELECT\n    sa.scheduler_code,\n    sa.username_std as creator_id\n  FROM `of-scheduler-proj.eros_source.scheduler_assignments` sa\n  WHERE sa.scheduler_code IS NOT NULL\n    AND sa.username_std IS NOT NULL\n),\n\nextended_recommendations AS (\n  SELECT\n    dr.username_std as creator_id,\n    dr.recommendation_date,\n    TIMESTAMP_TRUNC(dr.recommended_send_ts, HOUR) as recommended_time,\n    CASE\n      WHEN dr.price_tier = 'High' THEN 'PPV'\n      WHEN dr.price_tier = 'Medium' THEN 'PPV'\n      ELSE 'PPV'\n    END as action_type,\n    dr.suggested_price as recommended_price_usd,\n    CASE\n      WHEN dr.fatigue_safety_score >= 70 THEN 'LOW'\n      WHEN dr.fatigue_safety_score >= 40 THEN 'MEDIUM'\n      ELSE 'HIGH'\n    END as fatigue_risk_band,\n    CONCAT(\n      CASE\n        WHEN EXTRACT(DAYOFWEEK FROM dr.recommendation_date) IN (1, 7) THEN 'WE_'\n        WHEN EXTRACT(DAYOFWEEK FROM dr.recommendation_date) IN (2, 6) THEN 'HI_'\n        ELSE 'MED_'\n      END,\n      FORMAT('%02d', EXTRACT(HOUR FROM dr.recommended_send_ts)),\n      '_',\n      CASE\n        WHEN dr.fatigue_safety_score >= 70 THEN 'SAFE'\n        WHEN dr.fatigue_safety_score >= 40 THEN 'CAUTION'\n        ELSE 'RISK'\n      END\n    ) as reason_time_code\n  FROM `of-scheduler-proj.eros_messaging_mart.daily_recommendations` dr\n  WHERE dr.recommendation_rank = 1  -- Best recommendation per creator\n),\n\n-- Generate slots for all 7 days for each creator\nall_creator_days AS (\n  SELECT\n    scm.scheduler_code,\n    scm.creator_id,\n    nd.plan_date\n  FROM scheduler_creator_mapping scm\n  CROSS JOIN next_7_days nd\n),\n\nfinal_slots AS (\n  SELECT\n    acd.scheduler_code,\n    acd.creator_id,\n    acd.plan_date,\n    COALESCE(er.recommended_time,\n      TIMESTAMP_ADD(TIMESTAMP(acd.plan_date), INTERVAL (10 + MOD(ABS(FARM_FINGERPRINT(CONCAT(acd.creator_id, acd.plan_date))), 12)) HOUR)\n    ) as recommended_time,\n    COALESCE(er.action_type, 'PPV') as action_type,\n    COALESCE(er.recommended_price_usd, 19.99) as recommended_price_usd,\n    COALESCE(er.fatigue_risk_band, 'MEDIUM') as fatigue_risk_band,\n    COALESCE(er.reason_time_code, 'DEFAULT_TIMING') as reason_time_code\n  FROM all_creator_days acd\n  LEFT JOIN extended_recommendations er\n    ON acd.creator_id = er.creator_id\n    AND acd.plan_date = er.recommendation_date\n)\n\nSELECT\n  scheduler_code,\n  creator_id,\n  plan_date,\n  recommended_time,\n  action_type,\n  recommended_price_usd,\n  fatigue_risk_band,\n  reason_time_code\nFROM final_slots\nORDER BY scheduler_code, creator_id, plan_date",
          "schema": [
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "recommended_time",
              "type": "TIMESTAMP"
            },
            {
              "name": "action_type",
              "type": "STRING"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            }
          ]
        }
      ],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 0,
        "views": 11,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_core_dim",
      "description": "Core dimension tables for EROS intelligence engine",
      "location": "US",
      "created": "2025-09-18 12:43:50",
      "modified": "2025-09-18 12:43:50",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "dim_creator_timezone",
          "type": "TABLE",
          "description": "Authoritative creator timezone mapping (IANA)",
          "created": "2025-09-30 20:34:21",
          "modified": "2025-09-30 20:34:21",
          "size_bytes": 2891,
          "num_rows": 60,
          "schema": [
            {
              "name": "creator_sk",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "username_std",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "timezone_iana",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP",
              "mode": "NULLABLE"
            }
          ]
        }
      ],
      "views": [
        {
          "id": "vw_scheduler_cockpit_v1",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 02:52:57",
          "modified": "2025-09-19 02:52:57",
          "query": "WITH\nbase AS (\n  SELECT\n    -- unique id per creator+date+time (avoid collisions)\n    FARM_FINGERPRINT(CONCAT(\n      dr.username_std, '|',\n      CAST(dr.recommendation_date AS STRING), '|',\n      FORMAT_TIME('%H:%M:%S', EXTRACT(TIME FROM dr.recommended_send_ts))\n    )) AS rec_id,\n\n    dr.username_std                      AS creator_id,\n    dr.recommendation_date               AS plan_date,\n    EXTRACT(TIME FROM dr.recommended_send_ts) AS recommended_time,\n    dr.suggested_price                   AS recommended_price_usd,\n\n    -- Placeholders nulled to avoid misleading UI in V1\n    NULL AS action_type,\n    NULL AS expected_revenue_usd,\n    NULL AS expected_revenue_low_usd,\n    NULL AS expected_revenue_high_usd,\n    NULL AS confidence,\n    NULL AS model_version,\n\n    CURRENT_TIMESTAMP() AS view_refreshed_at,\n\n    -- Base timestamp in local tz for countdowns and alt-hour computations\n    TIMESTAMP(\n      DATETIME(dr.recommendation_date, EXTRACT(TIME FROM dr.recommended_send_ts)),\n      'America/Denver'\n    ) AS base_ts_mtz\n  FROM `of-scheduler-proj.eros_messaging_mart.daily_recommendations` dr\n  WHERE dr.recommendation_date BETWEEN DATE(CURRENT_DATE('America/Denver'))\n    AND DATE_ADD(CURRENT_DATE('America/Denver'), INTERVAL 6 DAY)\n),\n\nfeat AS (\n  SELECT\n    fs.username_std AS creator_id,\n    fs.score_date   AS plan_date,\n    ANY_VALUE(fs.fatigue_risk_score) AS fatigue_score,\n    NULL AS fatigue_trend_30d  -- not available yet\n  FROM `of-scheduler-proj.eros_ops_feat.fatigue_scores` fs\n  WHERE fs.score_date BETWEEN DATE(CURRENT_DATE('America/Denver'))\n    AND DATE_ADD(CURRENT_DATE('America/Denver'), INTERVAL 6 DAY)\n  GROUP BY 1,2\n),\n\n-- ðŸš¨ Critical fix: source has day names (\"Sunday\"..\"Saturday\"), map to BigQuery's 1..7\nheat AS (\n  SELECT\n    hm.username_std AS creator_id,\n    CASE\n      WHEN hm.local_day_of_week = 'Sunday'    THEN 1\n      WHEN hm.local_day_of_week = 'Monday'    THEN 2\n      WHEN hm.local_day_of_week = 'Tuesday'   THEN 3\n      WHEN hm.local_day_of_week = 'Wednesday' THEN 4\n      WHEN hm.local_day_of_week = 'Thursday'  THEN 5\n      WHEN hm.local_day_of_week = 'Friday'    THEN 6\n      WHEN hm.local_day_of_week = 'Saturday'  THEN 7\n    END AS dow,                      -- 1..7\n    hm.local_hour        AS hour_of_day,     -- 0..23\n    hm.avg_rpm           AS hour_perf_index\n  FROM `of-scheduler-proj.eros_messaging_feat.creator_heatmap` hm\n),\n\n-- Pricing bands intentionally nulled in V1 to avoid misleading UI\nprice AS (\n  SELECT\n    pb.username_std AS creator_id,\n    NULL AS action_type,\n    NULL AS price_band_label,\n    NULL AS price_band_index\n  FROM `of-scheduler-proj.eros_pricing_feat.pricing_bands` pb\n  GROUP BY 1\n),\n\nassign AS (\n  SELECT\n    username_std   AS creator_id,\n    scheduler_email\n  FROM `of-scheduler-proj.eros_source.scheduler_assignments_final`\n),\n\nevents_raw AS (\n  SELECT\n    creator_id,\n    DATE(start_ts) AS plan_date,\n    ARRAY_AGG(STRUCT(event_type, title, start_ts, end_ts) ORDER BY start_ts) AS events\n  FROM `of-scheduler-proj.eros_source.creator_calendar`\n  WHERE DATE(start_ts) BETWEEN DATE(CURRENT_DATE('America/Denver'))\n    AND DATE_ADD(CURRENT_DATE('America/Denver'), INTERVAL 6 DAY)\n  GROUP BY 1,2\n),\n\njoined AS (\n  SELECT\n    b.*,\n    a.scheduler_email,\n    f.fatigue_score,\n    f.fatigue_trend_30d,\n    p.price_band_label,\n    p.price_band_index,\n    COALESCE(\n      e.events,\n      ARRAY<STRUCT<event_type STRING, title STRING, start_ts TIMESTAMP, end_ts TIMESTAMP>>[]\n    ) AS events\n  FROM base b\n  LEFT JOIN assign     a USING (creator_id)\n  LEFT JOIN feat       f USING (creator_id, plan_date)\n  LEFT JOIN price      p USING (creator_id)\n  LEFT JOIN events_raw e USING (creator_id, plan_date)\n),\n\nreasoning AS (\n  SELECT\n    j.*,\n    CASE\n      WHEN j.price_band_index IS NULL THEN NULL\n      WHEN j.price_band_index >= 0.75 THEN 'PRICE:P75+'\n      WHEN j.price_band_index >= 0.50 THEN 'PRICE:P50-75'\n      WHEN j.price_band_index >= 0.25 THEN 'PRICE:P25-50'\n      ELSE 'PRICE:P<=25'\n    END AS reason_price_code,\n    CASE\n      WHEN h.hour_perf_index >= 0.90 THEN 'TIME:P90'\n      WHEN h.hour_perf_index >= 0.75 THEN 'TIME:P75'\n      WHEN h.hour_perf_index >= 0.50 THEN 'TIME:P50'\n      ELSE 'TIME:BASE'\n    END AS reason_time_code\n  FROM joined j\n  LEFT JOIN heat h\n    ON h.creator_id = j.creator_id\n   AND h.dow        = EXTRACT(DAYOFWEEK FROM j.plan_date)   -- 1..7\n   AND h.hour_of_day = EXTRACT(HOUR FROM j.recommended_time) -- 0..23\n),\n\nalts AS (\n  SELECT\n    r.rec_id,\n    ARRAY(\n      SELECT AS STRUCT\n        'RECOMMENDED' AS alt_rank,\n        EXTRACT(HOUR FROM r.recommended_time) AS hour_of_day,\n        r.recommended_time                    AS alt_time,\n        r.recommended_price_usd               AS alt_price_usd,\n        r.expected_revenue_low_usd            AS alt_rev_low_usd,\n        r.expected_revenue_usd                AS alt_rev_usd,\n        r.expected_revenue_high_usd           AS alt_rev_high_usd,\n        r.confidence                          AS alt_confidence\n      UNION ALL\n      SELECT AS STRUCT\n        'ALT_PREV_HOUR' AS alt_rank,\n        MOD(EXTRACT(HOUR FROM r.recommended_time) + 23, 24) AS hour_of_day,\n        TIME(TIMESTAMP_SUB(r.base_ts_mtz, INTERVAL 1 HOUR), 'America/Denver') AS alt_time,\n        r.recommended_price_usd AS alt_price_usd,\n        r.expected_revenue_low_usd  * COALESCE( (COALESCE(prev_h.hour_perf_index, 0.90) / NULLIF(curr_h.hour_perf_index, 0.0)), 0.90 ) AS alt_rev_low_usd,\n        r.expected_revenue_usd      * COALESCE( (COALESCE(prev_h.hour_perf_index, 0.90) / NULLIF(curr_h.hour_perf_index, 0.0)), 0.90 ) AS alt_rev_usd,\n        r.expected_revenue_high_usd * COALESCE( (COALESCE(prev_h.hour_perf_index, 0.90) / NULLIF(curr_h.hour_perf_index, 0.0)), 0.90 ) AS alt_rev_high_usd,\n        r.confidence AS alt_confidence\n      UNION ALL\n      SELECT AS STRUCT\n        'ALT_NEXT_HOUR' AS alt_rank,\n        MOD(EXTRACT(HOUR FROM r.recommended_time) + 1, 24) AS hour_of_day,\n        TIME(TIMESTAMP_ADD(r.base_ts_mtz, INTERVAL 1 HOUR), 'America/Denver') AS alt_time,\n        r.recommended_price_usd AS alt_price_usd,\n        r.expected_revenue_low_usd  * COALESCE( (COALESCE(next_h.hour_perf_index, 0.95) / NULLIF(curr_h.hour_perf_index, 0.0)), 0.95 ) AS alt_rev_low_usd,\n        r.expected_revenue_usd      * COALESCE( (COALESCE(next_h.hour_perf_index, 0.95) / NULLIF(curr_h.hour_perf_index, 0.0)), 0.95 ) AS alt_rev_usd,\n        r.expected_revenue_high_usd * COALESCE( (COALESCE(next_h.hour_perf_index, 0.95) / NULLIF(curr_h.hour_perf_index, 0.0)), 0.95 ) AS alt_rev_high_usd,\n        r.confidence AS alt_confidence\n    ) AS top3_alternatives\n  FROM reasoning r\n  LEFT JOIN heat curr_h\n    ON curr_h.creator_id = r.creator_id\n   AND curr_h.dow        = EXTRACT(DAYOFWEEK FROM r.plan_date)\n   AND curr_h.hour_of_day = EXTRACT(HOUR FROM r.recommended_time)\n  LEFT JOIN heat prev_h\n    ON prev_h.creator_id = r.creator_id\n   AND prev_h.dow        = EXTRACT(DAYOFWEEK FROM r.plan_date)\n   AND prev_h.hour_of_day = MOD(EXTRACT(HOUR FROM r.recommended_time) + 23, 24)\n  LEFT JOIN heat next_h\n    ON next_h.creator_id = r.creator_id\n   AND next_h.dow        = EXTRACT(DAYOFWEEK FROM r.plan_date)\n   AND next_h.hour_of_day = MOD(EXTRACT(HOUR FROM r.recommended_time) + 1, 24)\n),\n\nfinal AS (\n  SELECT\n    r.*,\n    CASE\n      WHEN r.fatigue_score >= 0.80 THEN 'HIGH'\n      WHEN r.fatigue_score >= 0.60 THEN 'MED'\n      ELSE 'LOW'\n    END AS fatigue_risk_band,\n    a.top3_alternatives,\n    -- countdowns\n    TIMESTAMP_DIFF(r.base_ts_mtz, CURRENT_TIMESTAMP(), HOUR) AS due_in_hours,\n    FORMAT('%s %s',\n      CASE WHEN TIMESTAMP_DIFF(r.base_ts_mtz, CURRENT_TIMESTAMP(), HOUR) < 0 THEN 'Started'\n           ELSE 'Due in' END,\n      CONCAT(CAST(ABS(TIMESTAMP_DIFF(r.base_ts_mtz, CURRENT_TIMESTAMP(), HOUR)) AS STRING), 'h')\n    ) AS due_chip\n  FROM reasoning r\n  LEFT JOIN alts a USING (rec_id)\n)\n\nSELECT\n  rec_id,\n  creator_id,\n  plan_date,\n  scheduler_email,\n  action_type,\n  recommended_time,\n  recommended_price_usd,\n  expected_revenue_usd,\n  expected_revenue_low_usd,\n  expected_revenue_high_usd,\n  confidence,\n  model_version,\n  view_refreshed_at,\n  fatigue_score,\n  fatigue_trend_30d,\n  fatigue_risk_band,\n  events,\n  reason_time_code,\n  reason_price_code,\n  top3_alternatives,\n  base_ts_mtz AS recommended_ts_mtz,\n  due_in_hours,\n  due_chip\nFROM final",
          "schema": [
            {
              "name": "rec_id",
              "type": "INTEGER"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "INTEGER"
            },
            {
              "name": "recommended_time",
              "type": "TIME"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "expected_revenue_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_low_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_high_usd",
              "type": "INTEGER"
            },
            {
              "name": "confidence",
              "type": "INTEGER"
            },
            {
              "name": "model_version",
              "type": "INTEGER"
            },
            {
              "name": "view_refreshed_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "fatigue_score",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_trend_30d",
              "type": "INTEGER"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "events",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "event_type",
                  "type": "STRING"
                },
                {
                  "name": "title",
                  "type": "STRING"
                },
                {
                  "name": "start_ts",
                  "type": "TIMESTAMP"
                },
                {
                  "name": "end_ts",
                  "type": "TIMESTAMP"
                }
              ]
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            },
            {
              "name": "reason_price_code",
              "type": "STRING"
            },
            {
              "name": "top3_alternatives",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "alt_rank",
                  "type": "STRING"
                },
                {
                  "name": "hour_of_day",
                  "type": "INTEGER"
                },
                {
                  "name": "alt_time",
                  "type": "TIME"
                },
                {
                  "name": "alt_price_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_low_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_high_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_confidence",
                  "type": "INTEGER"
                }
              ]
            },
            {
              "name": "recommended_ts_mtz",
              "type": "TIMESTAMP"
            },
            {
              "name": "due_in_hours",
              "type": "INTEGER"
            },
            {
              "name": "due_chip",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "vw_scheduler_cockpit_v1_rbac",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 02:53:07",
          "modified": "2025-09-19 02:53:07",
          "query": "SELECT *\nFROM `of-scheduler-proj.eros_core_dim.vw_scheduler_cockpit_v1`\nWHERE LOWER(scheduler_email) = LOWER(SESSION_USER())",
          "schema": [
            {
              "name": "rec_id",
              "type": "INTEGER"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "plan_date",
              "type": "DATE"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "action_type",
              "type": "INTEGER"
            },
            {
              "name": "recommended_time",
              "type": "TIME"
            },
            {
              "name": "recommended_price_usd",
              "type": "FLOAT"
            },
            {
              "name": "expected_revenue_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_low_usd",
              "type": "INTEGER"
            },
            {
              "name": "expected_revenue_high_usd",
              "type": "INTEGER"
            },
            {
              "name": "confidence",
              "type": "INTEGER"
            },
            {
              "name": "model_version",
              "type": "INTEGER"
            },
            {
              "name": "view_refreshed_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "fatigue_score",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_trend_30d",
              "type": "INTEGER"
            },
            {
              "name": "fatigue_risk_band",
              "type": "STRING"
            },
            {
              "name": "events",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "event_type",
                  "type": "STRING"
                },
                {
                  "name": "title",
                  "type": "STRING"
                },
                {
                  "name": "start_ts",
                  "type": "TIMESTAMP"
                },
                {
                  "name": "end_ts",
                  "type": "TIMESTAMP"
                }
              ]
            },
            {
              "name": "reason_time_code",
              "type": "STRING"
            },
            {
              "name": "reason_price_code",
              "type": "STRING"
            },
            {
              "name": "top3_alternatives",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "alt_rank",
                  "type": "STRING"
                },
                {
                  "name": "hour_of_day",
                  "type": "INTEGER"
                },
                {
                  "name": "alt_time",
                  "type": "TIME"
                },
                {
                  "name": "alt_price_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_low_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_rev_high_usd",
                  "type": "FLOAT"
                },
                {
                  "name": "alt_confidence",
                  "type": "INTEGER"
                }
              ]
            },
            {
              "name": "recommended_ts_mtz",
              "type": "TIMESTAMP"
            },
            {
              "name": "due_in_hours",
              "type": "INTEGER"
            },
            {
              "name": "due_chip",
              "type": "STRING"
            }
          ]
        }
      ],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 2,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_feat",
      "description": "",
      "location": "US",
      "created": "2025-09-19 07:37:22",
      "modified": "2025-09-19 07:37:22",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "caption_rank_next24_by_type",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-19 07:42:51",
          "modified": "2025-09-19 07:42:51",
          "size_bytes": 9067,
          "num_rows": 27,
          "schema": [
            {
              "name": "username_page",
              "type": "STRING"
            },
            {
              "name": "message_type",
              "type": "STRING"
            },
            {
              "name": "slot_dt_local",
              "type": "TIMESTAMP"
            },
            {
              "name": "hod",
              "type": "INTEGER"
            },
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "score",
              "type": "FLOAT"
            },
            {
              "name": "rn",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "captions_master",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-19 07:42:20",
          "modified": "2025-09-19 07:42:20",
          "size_bytes": 109515,
          "num_rows": 206,
          "schema": [
            {
              "name": "message_type",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_key",
              "type": "STRING"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "last_used_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "uses",
              "type": "INTEGER"
            },
            {
              "name": "revenue_total_usd",
              "type": "NUMERIC"
            },
            {
              "name": "buyers_total",
              "type": "INTEGER"
            },
            {
              "name": "impressions_total",
              "type": "INTEGER"
            },
            {
              "name": "price_median_usd",
              "type": "NUMERIC"
            },
            {
              "name": "caption_id",
              "type": "STRING"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 2,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_messaging_feat",
      "description": "Messaging feature engineering layer",
      "location": "US",
      "created": "2025-09-18 12:43:54",
      "modified": "2025-09-18 12:43:54",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "authenticity_monitor",
          "type": "TABLE",
          "description": "Authenticity monitoring; windows computed in CTE then aggregated.",
          "created": "2025-09-30 20:34:42",
          "modified": "2025-09-30 20:34:43",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "msg_count_30d",
              "type": "INTEGER"
            },
            {
              "name": "unique_hours_used_30d",
              "type": "INTEGER"
            },
            {
              "name": "exact_time_repetitions_30d",
              "type": "INTEGER"
            },
            {
              "name": "avg_spacing_minutes_30d",
              "type": "FLOAT"
            },
            {
              "name": "spacing_variance_30d",
              "type": "FLOAT"
            },
            {
              "name": "unique_messages_30d",
              "type": "INTEGER"
            },
            {
              "name": "message_repetitions_30d",
              "type": "INTEGER"
            },
            {
              "name": "pattern_risk_level",
              "type": "STRING"
            },
            {
              "name": "analysis_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "caption_bank_drip",
          "type": "TABLE",
          "description": "Specialized caption bank for drip bump messages with time-of-day energy matching and authenticity scoring",
          "created": "2025-09-30 20:34:19",
          "modified": "2025-09-30 20:34:22",
          "size_bytes": 2990,
          "num_rows": 17,
          "schema": [
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "drip_type",
              "type": "STRING"
            },
            {
              "name": "time_energy",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "authenticity_score",
              "type": "INTEGER"
            },
            {
              "name": "tone",
              "type": "STRING"
            },
            {
              "name": "tags",
              "type": "STRING",
              "mode": "REPEATED"
            },
            {
              "name": "times_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_date",
              "type": "DATE"
            },
            {
              "name": "created_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "caption_bank_renewal",
          "type": "TABLE",
          "description": "Specialized caption bank for renewal campaigns with FOMO and exclusive value propositions",
          "created": "2025-09-30 20:34:18",
          "modified": "2025-09-30 20:34:21",
          "size_bytes": 3679,
          "num_rows": 14,
          "schema": [
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "renewal_type",
              "type": "STRING"
            },
            {
              "name": "urgency_level",
              "type": "STRING"
            },
            {
              "name": "incentive_type",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "authenticity_score",
              "type": "INTEGER"
            },
            {
              "name": "tone",
              "type": "STRING"
            },
            {
              "name": "tags",
              "type": "STRING",
              "mode": "REPEATED"
            },
            {
              "name": "times_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_date",
              "type": "DATE"
            },
            {
              "name": "created_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "caption_bank_tip",
          "type": "TABLE",
          "description": "Specialized caption bank for tip campaigns with choice-based engagement and scarcity tactics",
          "created": "2025-09-30 20:34:19",
          "modified": "2025-09-30 20:34:22",
          "size_bytes": 3407,
          "num_rows": 15,
          "schema": [
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "tip_type",
              "type": "STRING"
            },
            {
              "name": "effort_level",
              "type": "STRING"
            },
            {
              "name": "reward_type",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "authenticity_score",
              "type": "INTEGER"
            },
            {
              "name": "tone",
              "type": "STRING"
            },
            {
              "name": "tags",
              "type": "STRING",
              "mode": "REPEATED"
            },
            {
              "name": "times_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_date",
              "type": "DATE"
            },
            {
              "name": "created_date",
              "type": "DATE"
            }
          ]
        },
        {
          "id": "caption_theme_signals",
          "type": "TABLE",
          "description": "Automated content themes, explicitness levels, and compliance flags for caption catalog",
          "created": "2025-09-30 20:34:29",
          "modified": "2025-09-30 20:34:29",
          "size_bytes": 6657702,
          "num_rows": 29426,
          "schema": [
            {
              "name": "caption_sk",
              "type": "INTEGER"
            },
            {
              "name": "caption_type",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "tagged_date",
              "type": "DATE"
            },
            {
              "name": "tagged_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "primary_theme",
              "type": "STRING"
            },
            {
              "name": "secondary_themes",
              "type": "STRING",
              "mode": "REPEATED"
            },
            {
              "name": "theme_keywords",
              "type": "STRING",
              "mode": "REPEATED"
            },
            {
              "name": "explicitness_level",
              "type": "STRING"
            },
            {
              "name": "explicitness_score",
              "type": "INTEGER"
            },
            {
              "name": "explicitness_keywords",
              "type": "STRING",
              "mode": "REPEATED"
            },
            {
              "name": "needs_compliance_review",
              "type": "BOOLEAN"
            }
          ]
        },
        {
          "id": "creator_heatmap",
          "type": "TABLE",
          "description": "Creator performance heatmap by hour/day for timing optimization",
          "created": "2025-09-30 20:34:42",
          "modified": "2025-09-30 20:34:42",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "local_day_of_week",
              "type": "STRING"
            },
            {
              "name": "local_hour",
              "type": "INTEGER"
            },
            {
              "name": "avg_rpm",
              "type": "FLOAT"
            },
            {
              "name": "avg_purchase_rate",
              "type": "FLOAT"
            },
            {
              "name": "avg_view_rate",
              "type": "FLOAT"
            },
            {
              "name": "message_count",
              "type": "INTEGER"
            },
            {
              "name": "total_sent",
              "type": "INTEGER"
            },
            {
              "name": "total_earnings",
              "type": "FLOAT"
            },
            {
              "name": "confidence_level",
              "type": "STRING"
            },
            {
              "name": "rpm_rank_for_creator",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "creator_page_assignments",
          "type": "TABLE",
          "description": "Page type assignments for each creator with FREE/PAID/BOTH detection",
          "created": "2025-09-30 20:34:22",
          "modified": "2025-09-30 20:34:22",
          "size_bytes": 10132,
          "num_rows": 60,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "final_page_type",
              "type": "STRING"
            },
            {
              "name": "messaging_strategy",
              "type": "STRING"
            },
            {
              "name": "is_primary_page",
              "type": "BOOLEAN"
            },
            {
              "name": "subscription_price",
              "type": "FLOAT"
            },
            {
              "name": "total_followers",
              "type": "INTEGER"
            },
            {
              "name": "weekly_revenue",
              "type": "FLOAT"
            },
            {
              "name": "rebill_rate",
              "type": "FLOAT"
            },
            {
              "name": "ppv_sends_7d",
              "type": "INTEGER"
            },
            {
              "name": "ppv_buys_7d",
              "type": "INTEGER"
            },
            {
              "name": "buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "assignment_date",
              "type": "DATE"
            },
            {
              "name": "strategy_description",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "creator_tier_assignments",
          "type": "TABLE",
          "description": "Creator tier assignments with page-type aware scoring and tier classification",
          "created": "2025-09-30 20:34:27",
          "modified": "2025-09-30 20:34:27",
          "size_bytes": 22878,
          "num_rows": 60,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "final_page_type",
              "type": "STRING"
            },
            {
              "name": "messaging_strategy",
              "type": "STRING"
            },
            {
              "name": "is_primary_page",
              "type": "BOOLEAN"
            },
            {
              "name": "base_tier",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "tier_score",
              "type": "FLOAT"
            },
            {
              "name": "tier_confidence",
              "type": "STRING"
            },
            {
              "name": "tier_description",
              "type": "STRING"
            },
            {
              "name": "base_daily_quota",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_drip_bumps",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_renewals",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_wall_posts",
              "type": "INTEGER"
            },
            {
              "name": "revenue_pct",
              "type": "FLOAT"
            },
            {
              "name": "followers_pct",
              "type": "FLOAT"
            },
            {
              "name": "buy_rate_pct",
              "type": "FLOAT"
            },
            {
              "name": "conversion_performance",
              "type": "STRING"
            },
            {
              "name": "revenue_performance",
              "type": "STRING"
            },
            {
              "name": "performance_risk",
              "type": "STRING"
            },
            {
              "name": "subscription_price",
              "type": "FLOAT"
            },
            {
              "name": "total_followers",
              "type": "INTEGER"
            },
            {
              "name": "weekly_revenue",
              "type": "FLOAT"
            },
            {
              "name": "rebill_rate",
              "type": "FLOAT"
            },
            {
              "name": "ppv_sends_7d",
              "type": "INTEGER"
            },
            {
              "name": "ppv_buys_7d",
              "type": "INTEGER"
            },
            {
              "name": "buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "assignment_date",
              "type": "DATE"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "assignment_version",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "messages_enriched",
          "type": "TABLE",
          "description": "Messages enriched with time features and performance metrics",
          "created": "2025-09-30 20:34:37",
          "modified": "2025-09-30 20:34:37",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "sending_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "price",
              "type": "FLOAT"
            },
            {
              "name": "sent_count",
              "type": "INTEGER"
            },
            {
              "name": "viewed_count",
              "type": "INTEGER"
            },
            {
              "name": "purchased_count",
              "type": "INTEGER"
            },
            {
              "name": "earnings_total",
              "type": "FLOAT"
            },
            {
              "name": "message_text",
              "type": "STRING"
            },
            {
              "name": "source_file",
              "type": "STRING"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "sending_date",
              "type": "DATE"
            },
            {
              "name": "local_sending_dt",
              "type": "DATETIME"
            },
            {
              "name": "local_hour",
              "type": "INTEGER"
            },
            {
              "name": "local_day_of_week",
              "type": "STRING"
            },
            {
              "name": "is_weekend",
              "type": "BOOLEAN"
            },
            {
              "name": "purchase_rate",
              "type": "FLOAT"
            },
            {
              "name": "rpm",
              "type": "FLOAT"
            },
            {
              "name": "view_rate",
              "type": "FLOAT"
            }
          ]
        },
        {
          "id": "tier_baseline_templates",
          "type": "TABLE",
          "description": "Baseline tier templates with quotas, pricing, and timing windows for each tier/page type combination",
          "created": "2025-09-30 20:34:18",
          "modified": "2025-09-30 20:34:18",
          "size_bytes": 8348,
          "num_rows": 8,
          "schema": [
            {
              "name": "tier_id",
              "type": "STRING"
            },
            {
              "name": "tier_name",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "base_tier",
              "type": "STRING"
            },
            {
              "name": "strategy",
              "type": "STRING"
            },
            {
              "name": "base_daily_quota",
              "type": "INTEGER"
            },
            {
              "name": "min_drip_bumps",
              "type": "INTEGER"
            },
            {
              "name": "max_drip_bumps",
              "type": "INTEGER"
            },
            {
              "name": "min_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_ppvs",
              "type": "INTEGER"
            },
            {
              "name": "min_renewals",
              "type": "INTEGER"
            },
            {
              "name": "max_renewals",
              "type": "INTEGER"
            },
            {
              "name": "mandatory_wall_posts",
              "type": "INTEGER"
            },
            {
              "name": "drip_schedule",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "label",
                  "type": "STRING"
                },
                {
                  "name": "base_time",
                  "type": "STRING"
                },
                {
                  "name": "template_type",
                  "type": "STRING"
                },
                {
                  "name": "hour",
                  "type": "INTEGER"
                },
                {
                  "name": "randomize_minutes",
                  "type": "INTEGER"
                }
              ]
            },
            {
              "name": "renewal_schedule",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "label",
                  "type": "STRING"
                },
                {
                  "name": "base_time",
                  "type": "STRING"
                },
                {
                  "name": "template_type",
                  "type": "STRING"
                },
                {
                  "name": "hour",
                  "type": "INTEGER"
                },
                {
                  "name": "randomize_minutes",
                  "type": "INTEGER"
                }
              ]
            },
            {
              "name": "premium_price_range",
              "type": "RECORD",
              "fields": [
                {
                  "name": "min",
                  "type": "FLOAT"
                },
                {
                  "name": "max",
                  "type": "FLOAT"
                }
              ]
            },
            {
              "name": "mid_price_range",
              "type": "RECORD",
              "fields": [
                {
                  "name": "min",
                  "type": "FLOAT"
                },
                {
                  "name": "max",
                  "type": "FLOAT"
                }
              ]
            },
            {
              "name": "teaser_price_range",
              "type": "RECORD",
              "fields": [
                {
                  "name": "min",
                  "type": "FLOAT"
                },
                {
                  "name": "max",
                  "type": "FLOAT"
                }
              ]
            },
            {
              "name": "ppv_windows",
              "type": "RECORD",
              "mode": "REPEATED",
              "fields": [
                {
                  "name": "label",
                  "type": "STRING"
                },
                {
                  "name": "time_range",
                  "type": "STRING"
                },
                {
                  "name": "price_type",
                  "type": "STRING"
                },
                {
                  "name": "hours",
                  "type": "INTEGER",
                  "mode": "REPEATED"
                }
              ]
            },
            {
              "name": "max_tip_campaigns_per_week",
              "type": "INTEGER"
            },
            {
              "name": "max_link_drops_per_day",
              "type": "INTEGER"
            },
            {
              "name": "description",
              "type": "STRING"
            },
            {
              "name": "min_spacing_minutes",
              "type": "INTEGER"
            },
            {
              "name": "randomize_offset_minutes",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "tier_weekly_adjustments",
          "type": "TABLE",
          "description": "Weekly performance-based adjustments to tier baseline templates",
          "created": "2025-09-30 20:34:43",
          "modified": "2025-09-30 20:34:43",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "base_tier",
              "type": "STRING"
            },
            {
              "name": "adjustment_date",
              "type": "DATE"
            },
            {
              "name": "adjustment_rule",
              "type": "STRING"
            },
            {
              "name": "adjustment_reasoning",
              "type": "STRING"
            },
            {
              "name": "adjustment_confidence",
              "type": "STRING"
            },
            {
              "name": "buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "rpm_current",
              "type": "FLOAT"
            },
            {
              "name": "rpm_trend",
              "type": "STRING"
            },
            {
              "name": "weekend_boost_ratio",
              "type": "FLOAT"
            },
            {
              "name": "conversion_tier",
              "type": "STRING"
            },
            {
              "name": "churn_tier",
              "type": "STRING"
            },
            {
              "name": "messages_sent_7d",
              "type": "INTEGER"
            },
            {
              "name": "total_revenue_7d",
              "type": "FLOAT"
            },
            {
              "name": "daily_quota_adjustment",
              "type": "INTEGER"
            },
            {
              "name": "price_adjustment_usd",
              "type": "FLOAT"
            },
            {
              "name": "weekend_premium_slots_adjustment",
              "type": "INTEGER"
            },
            {
              "name": "add_thankyou_content",
              "type": "BOOLEAN"
            },
            {
              "name": "valid_from_date",
              "type": "DATE"
            },
            {
              "name": "valid_until_date",
              "type": "DATE"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "adjustment_version",
              "type": "STRING"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 11,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_messaging_mart",
      "description": "Messaging data mart layer for analytics",
      "location": "US",
      "created": "2025-09-18 12:43:56",
      "modified": "2025-09-18 12:43:56",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "caption_rank_next24_v3_tbl",
          "type": "TABLE",
          "description": "Caption ranking system for next 24h with ML scoring",
          "created": "2025-09-30 20:34:38",
          "modified": "2025-09-30 20:34:38",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "username_page",
              "type": "STRING"
            },
            {
              "name": "slot_dt_local",
              "type": "DATE"
            },
            {
              "name": "hod",
              "type": "INTEGER"
            },
            {
              "name": "caption_id",
              "type": "INTEGER"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "rps_eb_price",
              "type": "FLOAT"
            },
            {
              "name": "style_score",
              "type": "FLOAT"
            },
            {
              "name": "se_bonus",
              "type": "FLOAT"
            },
            {
              "name": "historical_revenue",
              "type": "FLOAT"
            },
            {
              "name": "historical_roi",
              "type": "FLOAT"
            },
            {
              "name": "usage_count",
              "type": "INTEGER"
            },
            {
              "name": "rn",
              "type": "INTEGER"
            }
          ]
        },
        {
          "id": "daily_recommendations",
          "type": "TABLE",
          "description": "Tier-aware daily ranked recommendations solving all 6 core problems with page type intelligence",
          "created": "2025-09-30 20:34:49",
          "modified": "2025-09-30 20:34:49",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "final_page_type",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "messaging_strategy",
              "type": "STRING"
            },
            {
              "name": "recommendation_date",
              "type": "DATE"
            },
            {
              "name": "recommended_send_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "recommendation_rank",
              "type": "INTEGER"
            },
            {
              "name": "recommendation_score",
              "type": "FLOAT"
            },
            {
              "name": "timing_score",
              "type": "FLOAT"
            },
            {
              "name": "timing_confidence",
              "type": "STRING"
            },
            {
              "name": "price_tier",
              "type": "STRING"
            },
            {
              "name": "suggested_price",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_safety_score",
              "type": "FLOAT"
            },
            {
              "name": "daily_limit",
              "type": "INTEGER"
            },
            {
              "name": "in_tier_window",
              "type": "BOOLEAN"
            },
            {
              "name": "adjustment_rule",
              "type": "STRING"
            },
            {
              "name": "quota_adjustment",
              "type": "INTEGER"
            },
            {
              "name": "price_adjustment",
              "type": "FLOAT"
            },
            {
              "name": "min_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "max_daily_messages",
              "type": "INTEGER"
            },
            {
              "name": "fatigue_risk_score",
              "type": "FLOAT"
            },
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "recommendation_reason",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "enhanced_daily_recommendations",
          "type": "TABLE",
          "description": "Daily scheduling feed blending mandatory drips, renewals, PPVs, and tip campaigns with tier-aware AI scoring.",
          "created": "2025-09-30 20:34:55",
          "modified": "2025-09-30 20:34:55",
          "size_bytes": 177336,
          "num_rows": 558,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "final_page_type",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "recommendation_date",
              "type": "DATE"
            },
            {
              "name": "recommended_send_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "message_type",
              "type": "STRING"
            },
            {
              "name": "message_subtype",
              "type": "STRING"
            },
            {
              "name": "slot_description",
              "type": "STRING"
            },
            {
              "name": "recommendation_rank",
              "type": "INTEGER"
            },
            {
              "name": "recommendation_score",
              "type": "FLOAT"
            },
            {
              "name": "timing_confidence",
              "type": "STRING"
            },
            {
              "name": "price_tier",
              "type": "STRING"
            },
            {
              "name": "suggested_price",
              "type": "FLOAT"
            },
            {
              "name": "fatigue_safety_score",
              "type": "FLOAT"
            },
            {
              "name": "daily_limit",
              "type": "INTEGER"
            },
            {
              "name": "is_mandatory",
              "type": "BOOLEAN"
            },
            {
              "name": "opportunity_quality",
              "type": "STRING"
            },
            {
              "name": "recommendation_reason",
              "type": "STRING"
            },
            {
              "name": "time_energy_required",
              "type": "STRING"
            },
            {
              "name": "caption_guidance",
              "type": "STRING"
            },
            {
              "name": "spacing_ok",
              "type": "BOOLEAN"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            }
          ]
        },
        {
          "id": "tier_performance_analysis",
          "type": "TABLE",
          "description": "Performance analysis and effectiveness tracking for tier-based messaging system",
          "created": "2025-09-30 20:34:52",
          "modified": "2025-09-30 20:34:52",
          "size_bytes": 1109,
          "num_rows": 5,
          "schema": [
            {
              "name": "analysis_date",
              "type": "DATE"
            },
            {
              "name": "tier_id",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "messaging_strategy",
              "type": "STRING"
            },
            {
              "name": "base_tier",
              "type": "STRING"
            },
            {
              "name": "pages_in_tier",
              "type": "INTEGER"
            },
            {
              "name": "total_messages_sent",
              "type": "INTEGER"
            },
            {
              "name": "avg_messages_per_page",
              "type": "FLOAT"
            },
            {
              "name": "avg_daily_volume",
              "type": "FLOAT"
            },
            {
              "name": "template_min_daily",
              "type": "INTEGER"
            },
            {
              "name": "template_max_daily",
              "type": "INTEGER"
            },
            {
              "name": "volume_adherence_score",
              "type": "FLOAT"
            },
            {
              "name": "total_revenue",
              "type": "FLOAT"
            },
            {
              "name": "avg_revenue_per_message",
              "type": "FLOAT"
            },
            {
              "name": "median_revenue_per_message",
              "type": "FLOAT"
            },
            {
              "name": "revenue_rank_within_tier",
              "type": "INTEGER"
            },
            {
              "name": "overall_revenue_rank",
              "type": "INTEGER"
            },
            {
              "name": "overall_buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "total_purchases",
              "type": "INTEGER"
            },
            {
              "name": "total_recipients",
              "type": "INTEGER"
            },
            {
              "name": "conversion_rank_within_tier",
              "type": "INTEGER"
            },
            {
              "name": "overall_conversion_rank",
              "type": "INTEGER"
            },
            {
              "name": "avg_price_point",
              "type": "FLOAT"
            },
            {
              "name": "template_mid_min",
              "type": "FLOAT"
            },
            {
              "name": "template_premium_max",
              "type": "FLOAT"
            },
            {
              "name": "pricing_adherence_score",
              "type": "FLOAT"
            },
            {
              "name": "price_realization_rate",
              "type": "FLOAT"
            },
            {
              "name": "active_hours_compliance",
              "type": "FLOAT"
            },
            {
              "name": "tier_adherence_score",
              "type": "FLOAT"
            },
            {
              "name": "performance_vs_expectation",
              "type": "STRING"
            },
            {
              "name": "pages_with_adjustments",
              "type": "INTEGER"
            },
            {
              "name": "active_adjustment_rules",
              "type": "STRING"
            },
            {
              "name": "avg_quota_adjustment",
              "type": "FLOAT"
            },
            {
              "name": "avg_price_adjustment",
              "type": "FLOAT"
            },
            {
              "name": "post_adjustment_rpm",
              "type": "FLOAT"
            },
            {
              "name": "post_adjustment_buy_rate",
              "type": "FLOAT"
            },
            {
              "name": "optimization_recommendation",
              "type": "STRING"
            },
            {
              "name": "created_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "analysis_version",
              "type": "STRING"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 4,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_messaging_srv",
      "description": "Messaging service layer for applications",
      "location": "US",
      "created": "2025-09-18 12:44:07",
      "modified": "2025-09-18 12:44:07",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [],
      "views": [
        {
          "id": "scheduler_dashboard",
          "type": "VIEW",
          "description": "Scheduler dashboard summary combining enhanced recommendations with roster context",
          "created": "2025-09-30 20:34:57",
          "modified": "2025-09-30 20:34:57",
          "query": "SELECT\n  sa.scheduler_code,\n  sa.scheduler_display_name,\n  sa.scheduler_email,\n  sa.group_email,\n  r.username_std,\n  r.message_type,\n  r.message_subtype,\n  r.recommended_send_ts,\n  r.recommendation_rank,\n  r.opportunity_quality,\n  r.price_tier,\n  r.suggested_price,\n  r.recommendation_reason,\n  CASE\n    WHEN r.fatigue_safety_score < 30 THEN 'ðŸ”´ HIGH FATIGUE RISK'\n    WHEN r.fatigue_safety_score < 60 THEN 'ðŸŸ¡ MODERATE FATIGUE'\n    ELSE 'ðŸŸ¢ SAFE TO SEND'\n  END AS fatigue_status,\n  CASE\n    WHEN r.recommendation_score >= 0.8 THEN 'â­â­â­ EXCELLENT'\n    WHEN r.recommendation_score >= 0.6 THEN 'â­â­ GOOD'\n    WHEN r.recommendation_score >= 0.4 THEN 'â­ FAIR'\n    ELSE 'âš ï¸ LOW CONFIDENCE'\n  END AS opportunity_summary\nFROM `of-scheduler-proj.eros_messaging_mart.enhanced_daily_recommendations` r\nJOIN `of-scheduler-proj.eros_source.scheduler_assignments` sa\n  ON r.username_std = sa.username_std\nWHERE r.recommendation_date = CURRENT_DATE()\n  AND (r.is_mandatory OR r.recommendation_rank <= 3)\nORDER BY sa.scheduler_code, r.recommended_send_ts",
          "schema": [
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "scheduler_display_name",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "group_email",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "message_type",
              "type": "STRING"
            },
            {
              "name": "message_subtype",
              "type": "STRING"
            },
            {
              "name": "recommended_send_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "recommendation_rank",
              "type": "INTEGER"
            },
            {
              "name": "opportunity_quality",
              "type": "STRING"
            },
            {
              "name": "price_tier",
              "type": "STRING"
            },
            {
              "name": "suggested_price",
              "type": "FLOAT"
            },
            {
              "name": "recommendation_reason",
              "type": "STRING"
            },
            {
              "name": "fatigue_status",
              "type": "STRING"
            },
            {
              "name": "opportunity_summary",
              "type": "STRING"
            }
          ]
        }
      ],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 0,
        "views": 1,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_messaging_stg",
      "description": "Messaging staging layer for data processing",
      "location": "US",
      "created": "2025-09-18 12:43:52",
      "modified": "2025-09-18 12:43:52",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "captions",
          "type": "TABLE",
          "description": "Caption bank data for content analysis and optimization",
          "created": "2025-09-30 20:34:21",
          "modified": "2025-09-30 20:34:21",
          "size_bytes": 5194294,
          "num_rows": 29426,
          "schema": [
            {
              "name": "caption_sk",
              "type": "INTEGER"
            },
            {
              "name": "caption_type",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "loaded_date",
              "type": "DATE"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            }
          ]
        },
        {
          "id": "mass_messages",
          "type": "TABLE",
          "description": "Incremental mass messages with 14-day watermark and robust partition handling",
          "created": "2025-09-30 20:34:30",
          "modified": "2025-09-30 20:34:31",
          "size_bytes": 198,
          "num_rows": 1,
          "schema": [
            {
              "name": "message_sk",
              "type": "INTEGER"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "sending_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "price",
              "type": "FLOAT"
            },
            {
              "name": "sent_count",
              "type": "INTEGER"
            },
            {
              "name": "viewed_count",
              "type": "INTEGER"
            },
            {
              "name": "purchased_count",
              "type": "INTEGER"
            },
            {
              "name": "earnings_total",
              "type": "FLOAT"
            },
            {
              "name": "message_text",
              "type": "STRING"
            },
            {
              "name": "source_file",
              "type": "STRING"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            },
            {
              "name": "sending_date",
              "type": "DATE"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 2,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_ops",
      "description": "",
      "location": "US",
      "created": "2025-09-29 12:49:38",
      "modified": "2025-09-29 12:49:38",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "send_log",
          "type": "TABLE",
          "description": "Activity log for scheduler actions and message sending",
          "created": "2025-09-30 20:34:22",
          "modified": "2025-09-30 20:34:23",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "action_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "action_date",
              "type": "DATE"
            },
            {
              "name": "tracking_hash",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "username_page",
              "type": "STRING"
            },
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "date_local",
              "type": "DATE"
            },
            {
              "name": "hod_local",
              "type": "INTEGER"
            },
            {
              "name": "price_usd",
              "type": "FLOAT"
            },
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "status",
              "type": "STRING"
            },
            {
              "name": "action",
              "type": "STRING"
            },
            {
              "name": "source",
              "type": "STRING"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_ops_feat",
      "description": "Operations feature engineering layer",
      "location": "US",
      "created": "2025-09-18 12:44:11",
      "modified": "2025-09-18 12:44:11",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "fatigue_scores",
          "type": "TABLE",
          "description": "Daily fatigue scores to prevent over-messaging",
          "created": "2025-09-30 20:34:43",
          "modified": "2025-09-30 20:34:43",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "score_date",
              "type": "DATE",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_daily_volume_7d",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_rpm_7d",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "rpm_change_7d",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "fatigue_risk_score",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "volume_recommendation",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "recommended_max_daily",
              "type": "INTEGER",
              "mode": "NULLABLE"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_ops_mart",
      "description": "Operations data mart layer",
      "location": "US",
      "created": "2025-09-18 12:44:13",
      "modified": "2025-09-18 12:44:13",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "learning_insights",
          "type": "TABLE",
          "description": "Learning insights capturing human expertise and system performance patterns",
          "created": "2025-09-30 20:34:48",
          "modified": "2025-09-30 20:34:48",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "insight_category",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "username_std",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "insight_date",
              "type": "DATE",
              "mode": "NULLABLE"
            },
            {
              "name": "insight_text",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "insight_value",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "insight_confidence",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "insight_priority",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "generated_at",
              "type": "TIMESTAMP",
              "mode": "NULLABLE"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_ops_stg",
      "description": "Operations staging layer",
      "location": "US",
      "created": "2025-09-18 12:44:09",
      "modified": "2025-09-18 12:44:09",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "scheduler_overrides_ext",
          "type": "TABLE",
          "description": "External scheduler overrides and manual interventions",
          "created": "2025-09-30 20:34:20",
          "modified": "2025-09-30 20:34:20",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "override_sk",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "override_date",
              "type": "DATE"
            },
            {
              "name": "override_type",
              "type": "STRING"
            },
            {
              "name": "override_reason",
              "type": "STRING"
            },
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_pricing_feat",
      "description": "Pricing feature engineering layer",
      "location": "US",
      "created": "2025-09-18 12:44:22",
      "modified": "2025-09-18 12:44:22",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "pricing_bands",
          "type": "TABLE",
          "description": "Dynamic pricing bands based on performance data",
          "created": "2025-09-30 20:34:43",
          "modified": "2025-09-30 20:34:43",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "username_std",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "local_hour",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "local_day_of_week",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "price_low",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "price_medium",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "price_high",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "price_premium",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_rpm",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "price_conversion_correlation",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "recommended_price_tier",
              "type": "STRING",
              "mode": "NULLABLE"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_source",
      "description": "Raw source data ingestion layer",
      "location": "US",
      "created": "2025-09-18 12:44:25",
      "modified": "2025-09-18 12:44:25",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "caption_bank_bump_final",
          "type": "TABLE",
          "description": "BUMP caption bank with proper schema and performance optimization",
          "created": "2025-09-25 18:27:08",
          "modified": "2025-09-25 18:31:30",
          "size_bytes": 1827558,
          "num_rows": 12184,
          "schema": [
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_type",
              "type": "STRING"
            },
            {
              "name": "price_last_sent",
              "type": "FLOAT"
            },
            {
              "name": "word_count",
              "type": "INTEGER"
            },
            {
              "name": "length_category",
              "type": "STRING"
            },
            {
              "name": "best_time",
              "type": "STRING"
            },
            {
              "name": "theme_category",
              "type": "STRING"
            },
            {
              "name": "last_used_date",
              "type": "DATE"
            },
            {
              "name": "last_used_by",
              "type": "STRING"
            },
            {
              "name": "times_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_page",
              "type": "STRING"
            },
            {
              "name": "explicitness_level",
              "type": "STRING"
            },
            {
              "name": "created_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "status",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "caption_bank_ppv_final",
          "type": "TABLE",
          "description": "PPV caption bank with proper schema and performance optimization",
          "created": "2025-09-25 18:26:51",
          "modified": "2025-09-25 18:30:31",
          "size_bytes": 4915931,
          "num_rows": 16814,
          "schema": [
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_type",
              "type": "STRING"
            },
            {
              "name": "price_last_sent",
              "type": "FLOAT"
            },
            {
              "name": "word_count",
              "type": "INTEGER"
            },
            {
              "name": "length_category",
              "type": "STRING"
            },
            {
              "name": "best_time",
              "type": "STRING"
            },
            {
              "name": "theme_category",
              "type": "STRING"
            },
            {
              "name": "last_used_date",
              "type": "DATE"
            },
            {
              "name": "last_used_by",
              "type": "STRING"
            },
            {
              "name": "times_used",
              "type": "INTEGER"
            },
            {
              "name": "last_used_page",
              "type": "STRING"
            },
            {
              "name": "explicitness_level",
              "type": "STRING"
            },
            {
              "name": "created_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "status",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "caption_bank_renew_final",
          "type": "TABLE",
          "description": "RENEW caption bank with proper schema and performance optimization",
          "created": "2025-09-25 18:27:39",
          "modified": "2025-09-25 18:31:46",
          "size_bytes": 59624,
          "num_rows": 235,
          "schema": [
            {
              "name": "renew_campaign_id",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_type",
              "type": "STRING"
            },
            {
              "name": "days_before_expiry",
              "type": "INTEGER"
            },
            {
              "name": "incentive_type",
              "type": "STRING"
            },
            {
              "name": "renewal_rate_percent",
              "type": "FLOAT"
            },
            {
              "name": "ltv_impact_usd",
              "type": "FLOAT"
            },
            {
              "name": "best_time",
              "type": "STRING"
            },
            {
              "name": "urgency_level",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "last_used_days",
              "type": "INTEGER"
            },
            {
              "name": "status",
              "type": "STRING"
            },
            {
              "name": "notes",
              "type": "STRING"
            },
            {
              "name": "created_ts",
              "type": "TIMESTAMP"
            }
          ]
        },
        {
          "id": "caption_bank_tip_final",
          "type": "TABLE",
          "description": "TIP caption bank with proper schema and performance optimization",
          "created": "2025-09-25 18:28:28",
          "modified": "2025-09-25 18:32:00",
          "size_bytes": 71580,
          "num_rows": 193,
          "schema": [
            {
              "name": "tip_campaign_id",
              "type": "STRING"
            },
            {
              "name": "campaign_style",
              "type": "STRING"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_type",
              "type": "STRING"
            },
            {
              "name": "tip_amount",
              "type": "FLOAT"
            },
            {
              "name": "reward_offered",
              "type": "STRING"
            },
            {
              "name": "tip_rate_percent",
              "type": "FLOAT"
            },
            {
              "name": "avg_tip_usd",
              "type": "FLOAT"
            },
            {
              "name": "total_revenue_usd",
              "type": "FLOAT"
            },
            {
              "name": "best_day_time",
              "type": "STRING"
            },
            {
              "name": "engagement_score",
              "type": "INTEGER"
            },
            {
              "name": "last_used_days",
              "type": "INTEGER"
            },
            {
              "name": "status",
              "type": "STRING"
            },
            {
              "name": "notes",
              "type": "STRING"
            },
            {
              "name": "created_ts",
              "type": "TIMESTAMP"
            }
          ]
        },
        {
          "id": "creator_statistics_final",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-18 23:35:57",
          "modified": "2025-09-19 07:57:08",
          "size_bytes": 18262,
          "num_rows": 60,
          "schema": [
            {
              "name": "week_start_date",
              "type": "DATE",
              "mode": "NULLABLE"
            },
            {
              "name": "snapshot_ts_local",
              "type": "TIMESTAMP",
              "mode": "NULLABLE"
            },
            {
              "name": "snapshot_ts_utc",
              "type": "TIMESTAMP",
              "mode": "NULLABLE"
            },
            {
              "name": "snapshot_tz",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "username_std",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "creator_display",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "creator_group",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "subscription_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "new_subscriptions_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "recurring_subscriptions_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "tips_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "total_earnings_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "refund_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "contribution_percent",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "of_rank_percent",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "following_count",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "fans_with_renew_on",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "renew_on_percent",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "new_fans",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "active_fans",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "change_expired_fans_count",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "posts_net",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "message_net",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "streams_net",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_spend_per_spender_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_spend_per_transaction_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_earnings_per_fan_net",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "avg_subscription_length_days",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "reporting_currency",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "source_file",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "ingested_at",
              "type": "TIMESTAMP",
              "mode": "NULLABLE"
            }
          ]
        },
        {
          "id": "facts_messages_all",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-19 07:58:05",
          "modified": "2025-09-19 07:58:05",
          "size_bytes": 23556370,
          "num_rows": 66138,
          "schema": [
            {
              "name": "message",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "sending_time",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "sender",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "status",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "price",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "sent",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "viewed",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "purchased",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "earnings",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "withdrawn_by",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "message_id",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "source_file",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "loaded_at",
              "type": "STRING",
              "mode": "NULLABLE"
            }
          ]
        },
        {
          "id": "mass_message_daily_final",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-18 23:35:47",
          "modified": "2025-09-19 11:50:06",
          "size_bytes": 7284980,
          "num_rows": 20807,
          "schema": [
            {
              "name": "message",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "sending_time",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "sender",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "status",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "price",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "sent",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "viewed",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "purchased",
              "type": "INTEGER",
              "mode": "NULLABLE"
            },
            {
              "name": "earnings",
              "type": "FLOAT",
              "mode": "NULLABLE"
            },
            {
              "name": "withdrawn_by",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "message_id",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "source_file",
              "type": "STRING",
              "mode": "NULLABLE"
            },
            {
              "name": "loaded_at",
              "type": "TIMESTAMP",
              "mode": "NULLABLE"
            }
          ]
        },
        {
          "id": "scheduler_assignments",
          "type": "TABLE",
          "description": "Master scheduler to creator assignments for the EROS system",
          "created": "2025-09-30 20:34:27",
          "modified": "2025-09-30 20:34:27",
          "size_bytes": 5153,
          "num_rows": 39,
          "schema": [
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "group_email",
              "type": "STRING"
            },
            {
              "name": "scheduler_display_name",
              "type": "STRING"
            },
            {
              "name": "is_manager",
              "type": "BOOLEAN"
            },
            {
              "name": "assigned_creators",
              "type": "INTEGER"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "tier",
              "type": "STRING"
            },
            {
              "name": "full_tier_assignment",
              "type": "STRING"
            },
            {
              "name": "content_style",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "scheduler_assignments_final",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-25 20:12:05",
          "modified": "2025-09-25 20:12:39",
          "size_bytes": 403,
          "num_rows": 5,
          "schema": [
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_handle",
              "type": "STRING"
            },
            {
              "name": "assignment_date",
              "type": "DATE"
            },
            {
              "name": "status",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "scheduler_overrides_external",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-18 12:46:20",
          "modified": "2025-09-18 12:46:20",
          "size_bytes": 68,
          "num_rows": 1,
          "schema": [
            {
              "name": "username",
              "type": "STRING"
            },
            {
              "name": "override_date",
              "type": "DATE"
            },
            {
              "name": "override_type",
              "type": "STRING"
            },
            {
              "name": "override_reason",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            }
          ]
        },
        {
          "id": "scheduler_roster",
          "type": "TABLE",
          "description": "Scheduler roster with codes, contact emails, and assignment metadata",
          "created": "2025-09-30 20:34:22",
          "modified": "2025-09-30 20:34:22",
          "size_bytes": 1278,
          "num_rows": 16,
          "schema": [
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "display_name",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "group_email",
              "type": "STRING"
            },
            {
              "name": "is_active",
              "type": "BOOLEAN"
            },
            {
              "name": "is_manager",
              "type": "BOOLEAN"
            },
            {
              "name": "assigned_creators",
              "type": "INTEGER"
            }
          ]
        }
      ],
      "views": [
        {
          "id": "creator_calendar",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 02:18:13",
          "modified": "2025-09-19 02:18:13",
          "query": "SELECT\n  CAST(NULL AS STRING)   AS creator_id,\n  CAST(NULL AS TIMESTAMP) AS start_ts,\n  CAST(NULL AS TIMESTAMP) AS end_ts,\n  CAST(NULL AS STRING)   AS event_type,\n  CAST(NULL AS STRING)   AS title\nLIMIT 0",
          "schema": [
            {
              "name": "creator_id",
              "type": "STRING"
            },
            {
              "name": "start_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "end_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "event_type",
              "type": "STRING"
            },
            {
              "name": "title",
              "type": "STRING"
            }
          ]
        }
      ],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 11,
        "views": 1,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "eros_stg",
      "description": "",
      "location": "US",
      "created": "2025-09-19 07:37:19",
      "modified": "2025-09-19 07:37:19",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [],
      "views": [
        {
          "id": "facts_messages_all_stg",
          "type": "VIEW",
          "description": "",
          "created": "2025-09-19 07:41:53",
          "modified": "2025-09-19 07:41:53",
          "query": "SELECT\n  message_id,\n  username_std,\n  message_type,\n  sent_at_utc,\n  DATE(sent_at_utc, 'America/Denver') AS date_local,\n  EXTRACT(HOUR FROM sent_at_utc AT TIME ZONE 'America/Denver') AS hod_local,\n  price_usd, status,\n  impressions, buyers, revenue_usd,\n  caption_text,\n  LOWER(REGEXP_REPLACE(IFNULL(caption_text,''), r'\\s+', ' ')) AS caption_key\nFROM `of-scheduler-proj.eros_source.facts_messages_all`",
          "schema": [
            {
              "name": "message_id",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "message_type",
              "type": "STRING"
            },
            {
              "name": "sent_at_utc",
              "type": "TIMESTAMP"
            },
            {
              "name": "date_local",
              "type": "DATE"
            },
            {
              "name": "hod_local",
              "type": "INTEGER"
            },
            {
              "name": "price_usd",
              "type": "NUMERIC"
            },
            {
              "name": "status",
              "type": "STRING"
            },
            {
              "name": "impressions",
              "type": "INTEGER"
            },
            {
              "name": "buyers",
              "type": "INTEGER"
            },
            {
              "name": "revenue_usd",
              "type": "NUMERIC"
            },
            {
              "name": "caption_text",
              "type": "STRING"
            },
            {
              "name": "caption_key",
              "type": "STRING"
            }
          ]
        }
      ],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 0,
        "views": 1,
        "materialized_views": 0,
        "routines": 0
      }
    },
    {
      "id": "ops",
      "description": "",
      "location": "US",
      "created": "2025-09-19 07:37:27",
      "modified": "2025-09-19 07:37:27",
      "access_entries": [
        {
          "role": "WRITER",
          "specialGroup": "projectWriters"
        },
        {
          "role": "OWNER",
          "specialGroup": "projectOwners"
        },
        {
          "role": "OWNER",
          "userByEmail": "kyle@erosops.com"
        },
        {
          "role": "READER",
          "specialGroup": "projectReaders"
        }
      ],
      "tables": [
        {
          "id": "send_log",
          "type": "TABLE",
          "description": "",
          "created": "2025-09-19 07:43:50",
          "modified": "2025-09-19 07:43:50",
          "size_bytes": 0,
          "num_rows": 0,
          "schema": [
            {
              "name": "action_ts",
              "type": "TIMESTAMP"
            },
            {
              "name": "action_date",
              "type": "DATE"
            },
            {
              "name": "tracking_hash",
              "type": "STRING"
            },
            {
              "name": "username_std",
              "type": "STRING"
            },
            {
              "name": "page_type",
              "type": "STRING"
            },
            {
              "name": "username_page",
              "type": "STRING"
            },
            {
              "name": "scheduler_code",
              "type": "STRING"
            },
            {
              "name": "scheduler_email",
              "type": "STRING"
            },
            {
              "name": "date_local",
              "type": "DATE"
            },
            {
              "name": "hod_local",
              "type": "INTEGER"
            },
            {
              "name": "price_usd",
              "type": "NUMERIC"
            },
            {
              "name": "caption_id",
              "type": "STRING"
            },
            {
              "name": "status",
              "type": "STRING"
            },
            {
              "name": "action",
              "type": "STRING"
            },
            {
              "name": "source",
              "type": "STRING"
            }
          ]
        }
      ],
      "views": [],
      "materialized_views": [],
      "routines": [],
      "counts": {
        "tables": 1,
        "views": 0,
        "materialized_views": 0,
        "routines": 0
      }
    }
  ],
  "summary": {
    "total_datasets": 16,
    "total_tables": 37,
    "total_views": 35,
    "total_materialized_views": 0,
    "total_routines": 0,
    "total_scheduled_queries": 0
  }
}
