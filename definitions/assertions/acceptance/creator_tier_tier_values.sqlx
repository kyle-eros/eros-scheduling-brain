config {
  type: "assertion",
  schema: "eros_assertions",
  description: "creator_tier_assignments: allowed full_tier_assignment values",
  tags: ["data_quality","accepted_values"]
}

SELECT c.*
FROM ${ref("creator_tier_assignments")} c
WHERE LOWER(COALESCE(c.full_tier_assignment, '')) NOT IN (
  'a_free', 'a_paid'
  'b_free', 'b_paid'
  'c_free', 'c_paid'
  'd_free', 'd_paid'
  'enterprise', 'vip'
)
LIMIT 100
