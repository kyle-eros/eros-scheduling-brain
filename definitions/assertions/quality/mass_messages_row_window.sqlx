config {
  type: "assertion",
  schema: "eros_assertions",
  name: "mass_messages_row_window",
  description: "Ensures all data is within the expected 14-day window",
  tags: ["quality", "mass_messages"]
}

-- Check for data outside the expected window
SELECT 1
FROM ${ref("mass_messages")}
WHERE sending_date < DATE_SUB(CURRENT_DATE(), INTERVAL 14 DAY)
LIMIT 1