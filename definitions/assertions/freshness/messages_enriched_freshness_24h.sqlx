config {
  type: "assertion",
  schema: "eros_assertions",
  description: "SLA: messages_enriched has data in the last 24h",
  tags: ["data_quality","freshness","SLA"]
}

SELECT 'no_recent_messages_enriched' AS reason
WHERE NOT EXISTS (
  SELECT 1
  FROM \${ref("messages_enriched")}
  WHERE sending_date >= DATE_SUB(CURRENT_DATE(), INTERVAL 1 DAY)
  LIMIT 1
)
